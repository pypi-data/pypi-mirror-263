[tool.poetry]
name = "perigene"
version = "0.3.1"
description = "Polygenenic Enrichment for Risk Gene prioritization: a CLI tool and package to prioritize risk genes from GWAS summary statistics and gene features"
authors = ["Theo Dupuis <me@theodupuis.io>"]
license = "MIT"
readme = "README.rst"

packages = [{ include = "perigene", from = "src" }]
include = [{ path = "tests", format = "sdist" }]


[tool.poetry.scripts]
perigene = "perigene.cli:main"

[build-system]
requires = ["poetry-core"]
build-backend = "poetry.core.masonry.api"


# ##############################################################################
# ################################ Dependencies ################################
# ##############################################################################

[tool.poetry.dependencies]
python = "^3.10"

click = "^8.1.3"
click-option-group = "^0.5.5"
fastparquet = "^2022.12.0"
pandas = "^1.5.1"
numpy = "^1.23.4"
scikit-learn = "^1.1.3"
statsmodels = "^0.13.5"

natsort = "^8.2.0"
optuna = "^3.1.0"
xgboost = "^2"
filelock = "^3.13.1"
pyarrow = "^14.0.2"


[tool.poetry.group.dev]
optional = true

[tool.poetry.group.tests]
optional = true

[tool.poetry.group.linting]
optional = true

[tool.poetry.group.docs]
optional = true

[tool.poetry.group.dev.dependencies]
pre-commit = "^2.20.0"
icecream = "^2.1.3"

[tool.poetry.group.tests.dependencies]
pytest-cov = "^4.0"
tox = "^3.27.0"
coverage = "^6.5.0"
pytest = "^7.3"
hypothesis = "^6.56.4"

[tool.poetry.group.linting.dependencies]
black = { extras = ["jupyter"], version = "^22.10.0" }
flake8 = "^5.0.4"
mypy = "^0.982"
isort = "^5.11"
flake8-bugbear = "^22.10.27"
flake8-simplify = "^0.19.3"
nbqa = "^1.5.3"

[tool.poetry.group.docs.dependencies]
sphinx = "^7.2.6"
myst-parser = "^2.0.0"

# ##############################################################################
# #################################### Tools ###################################
# ##############################################################################

[tool.black]
target-version = ['py310']
include = '\.pyi?$'

[tool.coverage.paths]
source = ["src", "*/site-packages"]

[tool.coverage.run]
branch = true
source = ["perigene"]

[tool.coverage.report]
show_missing = true

[tool.isort]
profile = "black"

[tool.mypy]
files = ["src", "tests"]

[[tool.mypy.overrides]]
module = [
    'adjustText.*',
    'emoji.*',
    'IPython.*',
    'joblib.*',
    'matplotlib.*',
    'pandas.*',
    'papermill.*',
    'pyarrow.*',
    'pytest.*',
    'scipy.*',
    'seaborn.*',
    'sklearn.*',
    'statsmodels.*',
    'tqdm.*',
]
ignore_missing_imports = true


[tool.pytest]
addopts = "--ignore=setup.py"

[tool.pytest.ini_options]
filterwarnings = ['ignore:np.find_common_type is deprecated:DeprecationWarning']
# Skip integration tests by default
addopts = "-m 'not integration'"
markers = [
    "integration: marks tests as integration test (select with '-m  integration')",
]
