"use strict";(self.webpackChunk_secretflow_secretnote=self.webpackChunk_secretflow_secretnote||[]).push([[5987],{26529:function(Wr,Ve,d){d.r(Ve),d.d(Ve,{default:function(){return ve}});var ht=d(73193),Ke=d.n(ht),We=d(45332),g=d.n(We),Oe=d(23534),Je=d(64256),f=d(68625),Xe=d(11326),O=d(37678),R=d(58757),Q=d(89428),Ye=d(65941),q=d(95831),Qe=d(55844),S=d(86434),I=d(77014),Me=d(78796),qe=d.n(Me),Be=d(4977),et=d.n(Be),j=d(10154),Re=d.n(j),G=function(){function M(){qe()(this,M),Re()(this,"_terminal",void 0),Re()(this,"_cacheDecorations",new Map),Re()(this,"_highlightTimeout",0)}return et()(M,[{key:"activate",value:function(N){this._terminal=N}},{key:"_getLineProperty",value:function(N){for(var V=0,T=N.getCell(V),D=0,Z=!0,J=!0;T;)T.isBgDefault()||(Z=!1),T.isFgDefault()||(J=!1),D+=T.getWidth(),T=N.getCell(V),V++;return{width:D,isAllBgDefault:Z,isAllFgDefault:J}}},{key:"_decoration",value:function(N,V,T){if(this._terminal&&T&&T.decorations){var D=this._terminal,Z=this._getLineProperty(N),J=Z.width,ee=Z.isAllBgDefault,K=Z.isAllFgDefault;if(!(!ee||!K)){var ue=D.registerMarker(-D.buffer.active.baseY-D.buffer.active.cursorY+V);if(ue){var te={marker:ue,x:0,width:J,backgroundColor:T.decorations.matchBackground,foregroundColor:T.decorations.matchForegroundColor,layer:"bottom"},he=D.registerDecoration(te);he&&(he.onDispose(function(){ue.dispose()}),this._cacheDecorations.set(V,he))}}}}},{key:"_clearDecoration",value:function(){this._cacheDecorations.forEach(function(N){N.dispose()}),this._cacheDecorations.clear()}},{key:"_updateHighlight",value:function(N){var V=this;if(this._terminal&&Array.isArray(N)){this._clearDecoration();for(var T=this._terminal,D=0,Z=T.buffer.active.getLine(D),J,ee=function(){var ue,te=T.buffer.active.getLine(D+1),he=te?te.isWrapped:!1,Ae=(ue=Z)===null||ue===void 0?void 0:ue.translateToString(!he);if(Ae){var se;if((se=Z)!==null&&se!==void 0&&se.isWrapped&&J)V._decoration(Z,D,J);else{var be=N.find(function(Ne){var ge=Ne.keyword||"";if(Ne.ignoreSensitive){var ce=Ae.toLowerCase();return ce.includes(ge.toLowerCase())||ce.includes(ge)}return Ae.includes(ge)});J=be,V._decoration(Z,D,be)}}D++,Z=te};Z;)ee()}}},{key:"highlight",value:function(N){var V=this;if(this._terminal&&Array.isArray(N)){this._cacheDecorations=new Map;var T=this._terminal;T.onWriteParsed(function(){clearTimeout(V._highlightTimeout),V._highlightTimeout=window.setTimeout(function(){V._updateHighlight(N)},0)}),T.onResize(function(){clearTimeout(V._highlightTimeout),V._highlightTimeout=window.setTimeout(function(){V._updateHighlight(N)},0)})}}},{key:"dispose",value:function(){clearTimeout(this._highlightTimeout),this._cacheDecorations.clear()}}]),M}();function tt(M,_,N,V){var T=(0,R.useState)(),D=g()(T,2),Z=D[0],J=D[1],ee=(0,R.useRef)(V);return(0,R.useEffect)(function(){ee.current=V}),(0,R.useEffect)(function(){var K=new _;return N&&M&&(M.loadAddon(K),J(K),ee.current instanceof Function&&ee.current(M,K)),function(){J(void 0),K.dispose()}},[M,_,N]),Z}var w=tt;function nt(M,_){var N=(0,R.useRef)(M),V=(0,R.useRef)(0);return(0,R.useEffect)(function(){N.current=M}),(0,R.useEffect)(function(){return function(){clearTimeout(V.current)}},[]),(0,R.useCallback)(function(T){var D=T.target.value;clearTimeout(V.current),V.current=window.setTimeout(function(){N.current(D)},_)},[_])}var pe=nt,rt=d(23417),fe=function(_,N){var V=(0,R.useRef)(_);return(0,R.useEffect)(function(){V.current=_}),(0,R.useCallback)(function(){return(0,rt.Z)(V.current,N)()},[N])},at=fe,x=d(35667),_e={regex:!1,wholeWord:!1,caseSensitive:!1,incremental:!1,decorations:{matchForegroundColor:"#000000",matchBackground:"#f6c8ac",matchBorder:"none",matchOverviewRuler:"none",activeMatchBackground:"#babfb1",activeMatchBorder:"none",activeMatchColorOverviewRuler:"none"}},E={cursorBlink:!1,convertEol:!1,scrollback:Number.MAX_SAFE_INTEGER,drawBoldTextInBrightColors:!1,allowProposedApi:!0,allowTransparency:!0,fontSize:13,fontFamily:"Roboto Mono,Andale Mono,Consolas,Courier New,monospace",lineHeight:20/17,fastScrollSensitivity:35},me=[{keyword:"[error]",ignoreSensitive:!0,decorations:{matchForegroundColor:"red",matchBackground:"#24292e"}},{keyword:"[warn]",ignoreSensitive:!0,decorations:{matchForegroundColor:"yellow",matchBackground:"#24292e"}},{keyword:"[debug]",ignoreSensitive:!0,decorations:{matchForegroundColor:"cyan",matchBackground:"#24292e"}}],Ie=function(_){var N=(0,R.useState)(),V=g()(N,2),T=V[0],D=V[1],Z=(0,R.useState)(""),J=g()(Z,2),ee=J[0],K=J[1],ue=(0,R.useState)({resultIndex:-1,resultCount:0}),te=g()(ue,2),he=te[0],Ae=te[1],se=(0,R.useRef)(null),be=(0,R.useRef)(!1),Ne=_.theme||"dark",ge=(0,R.useRef)(0);(0,R.useEffect)(function(){var B=new Q.Terminal(Ke()(Ke()({},E),{},{theme:Ne==="dark"?{selectionBackground:"#fff",selectionForeground:"#fff",background:"#24292e",foreground:"#b5bbc6"}:{selectionBackground:"#b7d7fb",selectionForeground:"#000",background:"#fff",foreground:"#000"}}));return D(B),function(){try{B.dispose()}catch(u){}}},[]),(0,R.useEffect)(function(){return se.current&&T&&(T.open(se.current),be.current=!0),function(){T&&(T.clear(),be.current=!1)}},[T]),w(T,Ye.CanvasAddon,!!T),w(T,S.WebLinksAddon,!!T);var ce=w(T,q.FitAddon,!!T),ne=w(T,Qe.SearchAddon,!!T,(0,R.useCallback)(function(B,u){var Ce=u;Ce&&Ce.onDidChangeResults&&Ce.onDidChangeResults(function(ut){Ae(ut||{resultIndex:-1,resultCount:0})})},[]));w(T,G,!!T,function(B,u){var Ce=u;Ce&&Ce.highlight(me)}),(0,R.useEffect)(function(){if(T)if(_.code.length===0){T.clear(),ge.current=0;return}else{var B=_.code.slice(ge.current);if(B.length>0){var u=B.join("").replaceAll(`
`,`\r
`);T.write(u),ge.current=_.code.length}}},[T,_.code]);var ze=at(function(){be.current&&ce&&ce.fit&&ce.fit()},3e3);(0,R.useEffect)(function(){var B=new ResizeObserver(ze),u=se.current;return u&&B.observe(u),function(){u&&(B.unobserve(u),B.disconnect())}},[ce,ze]);var it=pe(function(B){ne&&ne.findNext(B,_e)},800),st=(0,R.useCallback)(function(){ne&&ne.findNext("",_e)},[ne]),ot=(0,R.useCallback)(function(B){ne&&ne.findPrevious(B,_e)},[ne]),ae=(0,R.useCallback)(function(B){ne&&ne.findNext(B,_e)},[ne]),De=(0,R.useCallback)(function(){T&&T.scrollToTop()},[T]),xe=(0,R.useCallback)(function(){T&&T.scrollToBottom()},[T]),lt=(0,x.jsxs)("div",{className:"terminal-viewer ".concat(Ne),children:[(0,x.jsx)("div",{className:"terminal-viewer-header",children:(0,x.jsxs)("div",{className:"terminal-viewer-input-wrapper",children:[(0,x.jsx)("input",{placeholder:"Search...",className:"terminal-viewer-input",value:ee,type:"text",onKeyDown:function(u){u.key==="Enter"&&ae(ee)},onChange:function(u){K(u.target.value),it(u)}}),(0,x.jsxs)("div",{className:"terminal-viewer-input-suffix",children:[ee&&(0,x.jsx)("span",{className:"input-suffix-search-result",children:he.resultCount}),(0,x.jsx)("span",{className:"input-suffix-clear",onClick:function(){K(""),st()},children:(0,x.jsx)(Oe.Z,{size:16})}),(0,x.jsx)("span",{className:"input-suffix-search-tool",onClick:function(){return ot(ee)},children:(0,x.jsx)(Je.Z,{size:16})}),(0,x.jsx)("span",{className:"input-suffix-search-tool",onClick:function(){return ae(ee)},children:(0,x.jsx)(f.Z,{size:16})})]})]})}),(0,x.jsx)("div",{className:"terminal-viewer-body",ref:se}),(0,x.jsxs)("div",{className:"terminal-viewer-toolbar",children:[(0,x.jsx)("div",{className:"terminal-viewer-toolbar-button",onClick:De,children:(0,x.jsx)(Xe.Z,{size:16})}),(0,x.jsx)("div",{className:"terminal-viewer-toolbar-button",onClick:xe,children:(0,x.jsx)(O.Z,{size:16})})]})]});return lt},ve=Ie},54649:function(Wr,Ve,d){d.r(Ve),d.d(Ve,{default:function(){return ni}});var ht=d(83109),Ke=d(43256),We=d(45362),g=d(58601),Oe=d(84880),Je=d(90819),f=d.n(Je),Xe=d(89933),O=d.n(Xe),R=d(78796),Q=d.n(R),Ye=d(4977),q=d.n(Ye),Qe=d(10154),S=d.n(Qe),I=d(47302),Me=Symbol("ComponentCellModelFactory"),qe=d(76711),Be=d.n(qe),et=d(73193),j=d.n(et),Re=d(26336),G=d.n(Re),tt=d(41553),w=d.n(tt),nt=d(49488),pe=d.n(nt),rt=d(84047),fe=d.n(rt),at=d(62055),x=d.n(at),_e=d(23202),E=d(38168),me=d(91798),Ie=d(53353),ve=d(17313),M=d(64495),_=d(20376),N=d(58757),V=d(64889),T=d(34011),D=d(34186),Z=d(39566),J=d(34319),ee=d(21381),K=d(38644),ue=d(58678),te=d(64940),he=function(a){return a.atomic.allowedValues?a.atomic.allowedValues.ss:[]},Ae=function(a){switch(a.type){case"AT_BOOL":return"boolean";case"AT_INT":return"number";case"AT_STRING":return"string";case"AT_FLOAT":return"number"}return"string"},se=function(a,n){var r,e,t,i;switch(a.type){case"AT_BOOL":return(r=a.atomic)===null||r===void 0||(r=r[n])===null||r===void 0?void 0:r.b;case"AT_INT":return(e=a.atomic)===null||e===void 0||(e=e[n])===null||e===void 0?void 0:e.i64;case"AT_STRING":return(t=a.atomic)===null||t===void 0||(t=t[n])===null||t===void 0?void 0:t.s;case"AT_FLOAT":return(i=a.atomic)===null||i===void 0||(i=i[n])===null||i===void 0?void 0:i.f}},be=function(a){return!a.atomic.isOptional},Ne=function(a){if(a.atomic.lowerBoundEnabled)return Number(se(a,"lowerBound"))},ge=function(a){if(a.atomic.upperBoundEnabled)return Number(se(a,"upperBound"))},ce=function(a,n,r){var e=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"/",t=Array.isArray(n)?n:n.split(e),i=t.pop();if(i){var s=a;t.forEach(function(o){(s[o]===null||s[o]===void 0)&&(s[o]={}),s=s[o]}),s[i]=r}return a},ne=function(a,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"/",e,t=Array.isArray(n)?n:n.split(r);if(t.length)for(e=a;t.length;){var i=t.shift();if(Object(e)===e&&i&&i in e)e=e[i];else return}return e},ze=function(a){var n={id:"$root",type:"object",title:"schema form",description:"",properties:{attrs:{id:"attrs",type:"object",title:"attrs",description:"",properties:{}},inputs:{id:"inputs",type:"object",title:"inputs",description:"",properties:{}},outputs:{id:"outputs",type:"object",title:"outputs",description:"",properties:{}}}};return(a.attrs||[]).forEach(function(r){var e=r.name,t=r.desc,i=Ae(r),s=he(r),o={id:e,type:i,title:e,description:t,$componentType:s.length>0?"select":"input",$options:s.map(function(l){return{label:l,value:l}}),$defaultValue:se(r,"defaultValue"),$required:be(r),minimum:Ne(r),maximum:ge(r)};ce(n,"properties/attrs/properties/".concat(e),o)}),(a.inputs||[]).forEach(function(r){var e=r.name,t={id:e,type:"object",title:e,description:r.desc,$componentType:"tableConfig",$inputTableConfig:{types:r.types,attrs:(r.attrs||[]).map(function(i){return i.name})}};ce(n,"properties/inputs/properties/".concat(e),t)}),(a.outputs||[]).forEach(function(r){var e=r.name,t={id:["output",e],type:"string",description:r.desc,title:e,$required:!0};ce(n,"properties/outputs/properties/".concat(e),t)}),n},it=d(86222),st=d.n(it),ot=d(45332),ae=d.n(ot),De=d(81590),xe=d(36756),lt=d(83869),B=d(95881),u=d(35667),Ce={span:8},ut={offset:4,span:12},Jr=[{key:"features"},{key:"feature_types"},{key:"labels"},{key:"label_types"},{key:"ids"},{key:"id_types"}],Xr=function(a){var n=a.value,r=a.onChange,e=function(i){var s,o=i;return n==null||(s=n[o])===null||s===void 0?void 0:s.join(",")};return(0,u.jsx)("span",{className:"schema-selector",children:Jr.map(function(t){return(0,u.jsx)(K.Z.Item,{labelCol:Ce,wrapperCol:ut,label:t.key,children:(0,u.jsx)(te.Z,{defaultValue:e(t.key),onChange:function(s){r&&r(S()({},t.key,s.target.value.split(",")))}})},t.key)})})},Yr=function(a){var n=(0,N.useState)(),r=ae()(n,2),e=r[0],t=r[1],i=function(){var p=O()(f()().mark(function h(){var b,m,C,A,v,k,F,z,H;return f()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return b=[],m="api/nodes",C={method:"GET"},L.next=5,(0,B.WY)(m,C);case 5:A=L.sent,v=st()(A),L.prev=7,v.s();case 9:if((k=v.n()).done){L.next=18;break}return F=k.value,z=F.address,L.next=14,(0,B.WY)("http://".concat(z,"/api/contents"),{method:"GET"});case 14:H=L.sent,b.push({label:F.name,value:F.name,children:H.content.filter(function(W){return W.name.endsWith(".csv")}).map(function(W){return{label:W.name,value:W.name}})});case 16:L.next=9;break;case 18:L.next=23;break;case 20:L.prev=20,L.t0=L.catch(7),v.e(L.t0);case 23:return L.prev=23,v.f(),L.finish(23);case 26:t(b);case 27:case"end":return L.stop()}},h,null,[[7,20,23,26]])}));return function(){return p.apply(this,arguments)}}();(0,N.useEffect)(function(){i()},[]);var s=function(h){var b,m=(((b=a.value)===null||b===void 0?void 0:b.data_ref)||[])[h];return m?[m.party,m.uri]:[]},o=function(h){var b,m=((b=a.value)===null||b===void 0?void 0:b.data_ref)||[];if(m.length>1){var C;return(C=a.value)===null||C===void 0||(C=C.schemas)===null||C===void 0?void 0:C[h]}else if(m.length===1){var A;return(A=a.value)===null||A===void 0?void 0:A.schema}},l=function(h,b){if(a.onChange)if(b&&b.length===2){var m,C=ae()(b,2),A=C[0],v=C[1],k=((m=a.value)===null||m===void 0?void 0:m.data_ref)||[];k[h]={uri:v,party:A},a.onChange(j()(j()({},a.value),{},{data_ref:k}))}else{var F,z=((F=a.value)===null||F===void 0?void 0:F.data_ref)||[];z.splice(h,1),a.onChange(j()(j()({},a.value),{},{data_ref:z}))}},y=function(h,b){if(a.onChange){var m,C=((m=a.value)===null||m===void 0?void 0:m.data_ref)||[];if(C.length>1){var A,v=((A=a.value)===null||A===void 0?void 0:A.schemas)||[];v[h]=j()(j()({},v[h]),b),a.onChange(j()(j()({},a.value),{},{schemas:v,schema:void 0}))}else if(C.length===1){var k;a.onChange(j()(j()({},a.value),{},{schema:j()(j()({},(k=a.value)===null||k===void 0?void 0:k.schema),b),schemas:void 0}))}}};return(0,u.jsx)("span",{children:e==null?void 0:e.map(function(p,h){return(0,u.jsx)("span",{className:"table-selector",children:p.children.length>0?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(De.Z,{defaultValue:s(h),options:e,onChange:function(m){return l(h,m)}}),(0,u.jsx)(xe.Z,{content:(0,u.jsx)(Xr,{value:o(h),onChange:function(m){return y(h,m)}}),placement:"right",title:"",overlayClassName:"secretnote-table-selector-popover",trigger:"click",arrow:!1,children:(0,u.jsx)(lt.Z,{size:14,cursor:"pointer"})})]}):(0,u.jsx)("span",{className:"no-table",children:"No table to choose."},p.value)},p.value)})})},Fe={span:8},Pe={offset:4,span:12},Qr={tableConfig:function(a){var n=a.root,r=ne(n,"$inputTableConfig/types"),e=ne(n,"$inputTableConfig/attrs"),t=function(){var o=a.form.getFieldValue(["input",n.id,"type"]);if(o)return o.split(".")[1]},i=t();return(0,u.jsxs)(K.Z.Item,{label:n.id,labelCol:{span:24},wrapperCol:{offset:1},className:"table-config-item",children:[(0,u.jsx)(K.Z.Item,{label:"type",name:["input",n.id,"type"],labelCol:Fe,wrapperCol:Pe,children:(0,u.jsx)(ue.Z,{options:r.map(function(s){return{label:s,value:s}})})}),e.map(function(s){return(0,u.jsx)(K.Z.Item,{label:s,name:"input/".concat(n.id,"/").concat(s),labelCol:Fe,wrapperCol:Pe,children:(0,u.jsx)(te.Z,{})},s)}),i==="table"&&(0,u.jsx)(K.Z.Item,{label:"tables",name:["input",n.id,"tables"],labelCol:Fe,wrapperCol:Pe,dependencies:["input",n.id,"type"],children:(0,u.jsx)(Yr,{})}),i==="model"&&(0,u.jsx)(K.Z.Item,{label:"model",name:["input",n.id,"model"],labelCol:Fe,wrapperCol:Pe,dependencies:["input",n.id,"type"],children:(0,u.jsx)(te.Z,{})}),i==="rule"&&(0,u.jsx)(K.Z.Item,{label:"rule",name:["input",n.id,"rule"],labelCol:Fe,wrapperCol:Pe,dependencies:["input",n.id,"type"],children:(0,u.jsx)(te.Z,{})})]},n.id)}},gt=(0,N.forwardRef)(function(c,a){return(0,u.jsx)("div",{className:"component-form",children:(0,u.jsx)(ee.ZP,{ref:a,json:ze(c.config),value:c.defaultValue,customComponent:Qr,formOptions:{size:"small",layout:"horizontal",labelAlign:"left",labelCol:{span:8},wrapperCol:{span:12,offset:4},initialValues:c.defaultValue,onValuesChange:function(r,e){var t;console.log(e),(t=c.onValuesChange)===null||t===void 0||t.call(c,r,e)}}})})});gt.displayName="ComponentForm";var qr=d(26529),ea=d(84176),ta=d.n(ea),na=["input","output"],ra={runtime_config:{protocol:"REF2K",field:"FM64"},link_desc:{connect_retry_times:60,connect_retry_interval_ms:1e3,brpc_channel_protocol:"http",brpc_channel_connection_type:"pooled",recv_timeout_ms:12e5,http_timeout_ms:12e5}},yt=8e3,bt=8001,aa={public_config:{ray_fed_config:{parties:["alice","bob"],addresses:["alice:".concat(yt),"bob:".concat(yt)]},spu_configs:[{name:"spu",parties:["alice","bob"],addresses:["alice:".concat(bt),"bob:".concat(bt)]}]},private_config:{self_party:"{self_party}",ray_head_addr:"127.0.0.1:6379"},desc:{parties:["alice","bob"],devices:[{name:"spu",type:"spu",parties:["alice","bob"],config:JSON.stringify(ra)},{name:"heu",type:"heu",parties:[],config:JSON.stringify({mode:"PHEU",schema:"paillier",key_size:2048})}]}},ia=function(a,n,r){var e=(a.attrs||[]).find(function(i){return i.name===n});if(e){var t=e.type;switch(t){case"AT_INT":return{i64:r};case"AT_BOOL":return{b:r};case"AT_STRING":return{s:r};case"AT_FLOAT":return{f:r};default:return{s:r}}}else return{ss:(r||"").split(",")}},sa=function(a){var n={"sf.table.individual":"secretflow.spec.v1.IndividualTable","sf.table.vertical_table":"secretflow.spec.v1.VerticalTable","sf.rule.binning":"secretflow.spec.extend.DeviceObjectCollection","sf.model.sgb":"secretflow.spec.extend.DeviceObjectCollection","sf.model.ss_glm":"secretflow.spec.extend.DeviceObjectCollection","sf.model.ss_sgd":"secretflow.spec.extend.DeviceObjectCollection","sf.model.ss_xgb":"secretflow.spec.extend.DeviceObjectCollection","sf.report":"secretflow.spec.v1.Report"};return n[a]?"type.googleapis.com/".concat(n[a]):""},oa=["feature.vert_binning","feature.vert_woe_binning","ml.train.ss_xgb_train","ml.train.ss_glm_train","ml.train.ss_sgd_train","ml.train.sgb_train"],Ct=function(a,n){if(!(a&&n))return"";var r=Symbol("__extra"),e=S()(S()(S()(S()(S()(S()(S()(S()({},r,{}),"domain",a.domain),"name",a.name),"version",a.version),"attr_paths",[]),"attrs",[]),"inputs",[]),"output_uris",[]),t=n.input,i=n.output,s=ta()(n,na);s&&Object.entries(s).forEach(function(p){var h=ae()(p,2),b=h[0],m=h[1];e.attr_paths.push(b);var C=ia(a,b,m);e.attrs.push(C)}),t&&Object.entries(t).forEach(function(p){var h=ae()(p,2),b=h[0],m=h[1],C=m,A=C.type;if(A){var v=A.split(".")[1];switch(v){case"table":{var k=m.tables,F=A==="sf.table.individual"?"schema":"schemas";k&&e.inputs.push({name:b,type:A,data_refs:k.data_ref.map(function(P){return{uri:P.uri,party:P.party,format:"csv"}}),meta:S()(S()({"@type":sa(A)},F,k[F]),"line_count",-1)});break}case"model":{var z=m.model;z&&(e[r].model=z);break}case"rule":{var H=m.rule;H&&(e[r].rule=H);break}case"report":throw new Error("Report is not expected to be used as input.")}}}),i&&Object.entries(i).forEach(function(p){var h=ae()(p,2),b=h[1];e.output_uris.push(b)});var o=oa.includes("".concat(e.domain,".").concat(e.name))?Be()(e.output_uris):void 0,l=o?"".concat(o.join(" = ")," = None"):"",y=o?"global ".concat(o.join(", "),`
`)+o.map(function(p,h){return"  ".concat(p," = res.outputs[").concat(h,"]")}).join(`
`):"";return`
`.concat(l,`
def __run_component(): # limit the scope to avoid polluting global
  from secretflow.spec.v1.evaluation_pb2 import NodeEvalParam
  from secretflow.spec.v1.data_pb2 import StorageConfig
  from secretflow.spec.extend.cluster_pb2 import SFClusterConfig
  from secretflow.component.entry import comp_eval
  from google.protobuf.json_format import Parse, MessageToJson
  from ipykernel.comm import Comm
  import os

  cluster_config_str = r"""
  `).concat(JSON.stringify(aa),`
  """

  component_config_str = r"""
  `).concat(JSON.stringify(e),`
  """

  self_party = os.getenv("SELF_PARTY", "alice")
  cluster_config = SFClusterConfig()
  Parse(cluster_config_str.replace('{self_party}', self_party), cluster_config)

  node_eval_config = NodeEvalParam()
  Parse(component_config_str, node_eval_config)
  `).concat(e[r].model?"node_eval_config.inputs.insert(0, ".concat(e[r].model,")"):"",`
  `).concat(e[r].rule?"node_eval_config.inputs.append(".concat(e[r].rule,")"):"",`
  
  storage_config = StorageConfig(
      type="local_fs",
      local_fs=StorageConfig.LocalFSConfig(wd=os.getcwd()),
  )

  res = comp_eval(node_eval_config, storage_config, cluster_config)

  print(f"The execution is complete and the result is: \\n{res}")

  `).concat(y,`

  Comm().send(data={"$type": "component-cell.result", "payload": MessageToJson(res, indent=0)})

__run_component()
    `).trim()},wt=d(86919),kt=JSON.parse(`{"$9":[{"domain":"preprocessing","name":"vert_bin_substitution","desc":"Substitute datasets' value by bin substitution rules.","version":"0.0.1","inputs":[{"name":"input_data","desc":"Vertical partitioning dataset to be substituted.","types":["sf.table.vertical_table"]},{"name":"bin_rule","desc":"Input bin substitution rule.","types":["sf.rule.binning"]}],"outputs":[{"name":"output_data","desc":"Output vertical table.","types":["sf.table.vertical_table"]}]},{"domain":"feature","name":"vert_binning","desc":"Generate equal frequency or equal range binning rules for vertical partitioning datasets.","version":"0.0.1","attrs":[{"name":"binning_method","desc":"How to bin features with numeric types: \\"quantile\\"(equal frequency)/\\"eq_range\\"(equal range)","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"eq_range"},"allowedValues":{"ss":["eq_range","quantile"]}}},{"name":"bin_num","desc":"Max bin counts for one features.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{}}}],"inputs":[{"name":"input_data","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"feature_selects","desc":"which features should be binned.","colMinCntInclusive":"1"}]}],"outputs":[{"name":"bin_rule","desc":"Output bin rule.","types":["sf.rule.binning"]}]},{"domain":"feature","name":"vert_woe_binning","desc":"Generate Weight of Evidence (WOE) binning rules for vertical partitioning datasets.","version":"0.0.1","attrs":[{"name":"secure_device_type","desc":"Use SPU(Secure multi-party computation or MPC) or HEU(Homomorphic encryption or HE) to secure bucket summation.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"spu"},"allowedValues":{"ss":["spu","heu"]}}},{"name":"binning_method","desc":"How to bin features with numeric types: \\"quantile\\"(equal frequency)/\\"chimerge\\"(ChiMerge from AAAI92-019: https://www.aaai.org/Papers/AAAI/1992/AAAI92-019.pdf)","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"quantile"},"allowedValues":{"ss":["quantile","chimerge"]}}},{"name":"bin_num","desc":"Max bin counts for one features.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"positive_label","desc":"Which value represent positive value in label.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"1"}}},{"name":"chimerge_init_bins","desc":"Max bin counts for initialization binning in ChiMerge.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"100"},"lowerBoundEnabled":true,"lowerBound":{"i64":"2"}}},{"name":"chimerge_target_bins","desc":"Stop merging if remaining bin counts is less than or equal to this value.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{"i64":"2"},"lowerBoundInclusive":true}},{"name":"chimerge_target_pvalue","desc":"Stop merging if biggest pvalue of remaining bins is greater than this value.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}}],"inputs":[{"name":"input_data","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"feature_selects","desc":"which features should be binned.","colMinCntInclusive":"1"},{"name":"label","desc":"Label of input data.","colMinCntInclusive":"1"}]}],"outputs":[{"name":"bin_rule","desc":"Output WOE rule.","types":["sf.rule.binning"]}]},{"domain":"ml.eval","name":"biclassification_eval","desc":"Statistics evaluation for a bi-classification model on a dataset.\\n1. summary_report: SummaryReport\\n2. group_reports: List[GroupReport]\\n3. eq_frequent_bin_report: List[EqBinReport]\\n4. eq_range_bin_report: List[EqBinReport]\\n5. head_report: List[PrReport]\\nreports for fpr = 0.001, 0.005, 0.01, 0.05, 0.1, 0.2","version":"0.0.1","attrs":[{"name":"bucket_size","desc":"Number of buckets.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true}},{"name":"min_item_cnt_per_bucket","desc":"Min item cnt per bucket. If any bucket doesn't meet the requirement, error raises. For security reasons, we require this parameter to be at least 5.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"5"},"lowerBoundEnabled":true,"lowerBound":{"i64":"5"},"lowerBoundInclusive":true}}],"inputs":[{"name":"in_ds","desc":"Input table with predictions.","types":["sf.table.vertical_table","sf.table.individual"],"attrs":[{"name":"label","desc":"Label column name of input data.","colMaxCntInclusive":"1"},{"name":"prediction","desc":"Prediction column name of input data.","colMaxCntInclusive":"1"}]}],"outputs":[{"name":"reports","desc":"Output report.","types":["sf.report"]}]},{"domain":"ml.eval","name":"prediction_bias_eval","desc":"Calculate prediction bias, ie. average of predictions - average of labels.","version":"0.0.1","attrs":[{"name":"bucket_num","desc":"Num of bucket.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true}},{"name":"min_item_cnt_per_bucket","desc":"Min item cnt per bucket. If any bucket doesn't meet the requirement, error raises. For security reasons, we require this parameter to be at least 2.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"2"},"lowerBoundEnabled":true,"lowerBound":{"i64":"2"},"lowerBoundInclusive":true}},{"name":"bucket_method","desc":"Bucket method.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"equal_width"},"allowedValues":{"ss":["equal_width","equal_frequency"]}}}],"inputs":[{"name":"in_ds","desc":"Input table with predictions.","types":["sf.table.vertical_table","sf.table.individual"],"attrs":[{"name":"label","desc":"Label column name of input data.","colMaxCntInclusive":"1"},{"name":"prediction","desc":"Prediction column name of input data.","colMaxCntInclusive":"1"}]}],"outputs":[{"name":"result","desc":"Output report.","types":["sf.report"]}]},{"domain":"ml.eval","name":"ss_pvalue","desc":"Calculate P-Value for LR model training on vertical partitioning dataset by using secret sharing.\\nFor large dataset(large than 10w samples & 200 features),\\nrecommend to use [Ring size: 128, Fxp: 40] options for SPU device.","version":"0.0.1","inputs":[{"name":"model","desc":"Input model.","types":["sf.model.ss_sgd"]},{"name":"input_data","desc":"Input vertical table.","types":["sf.table.vertical_table"]}],"outputs":[{"name":"report","desc":"Output P-Value report.","types":["sf.report"]}]},{"domain":"ml.predict","name":"sgb_predict","desc":"Predict using SGB model.","version":"0.0.2","attrs":[{"name":"receiver","desc":"Party of receiver.","type":"AT_STRING","atomic":{}},{"name":"pred_name","desc":"Name for prediction column","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"pred"}}},{"name":"save_ids","desc":"Whether to save ids columns into output prediction table. If true, input feature_dataset must contain id columns, and receiver party must be id owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"save_label","desc":"Whether or not to save real label columns into output pred file. If true, input feature_dataset must contain label columns and receiver party must be label owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}}],"inputs":[{"name":"model","desc":"model","types":["sf.model.sgb"]},{"name":"feature_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"]}],"outputs":[{"name":"pred","desc":"Output prediction.","types":["sf.table.individual"]}]},{"domain":"ml.predict","name":"ss_glm_predict","desc":"Predict using the SSGLM model.","version":"0.0.1","attrs":[{"name":"receiver","desc":"Party of receiver.","type":"AT_STRING","atomic":{}},{"name":"pred_name","desc":"Column name for predictions.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"pred"}}},{"name":"save_ids","desc":"Whether to save ids columns into output prediction table. If true, input feature_dataset must contain id columns, and receiver party must be id owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"save_label","desc":"Whether or not to save real label columns into output pred file. If true, input feature_dataset must contain label columns and receiver party must be label owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"offset_col","desc":"Specify a column to use as the offset","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{}}}],"inputs":[{"name":"model","desc":"Input model.","types":["sf.model.ss_glm"]},{"name":"feature_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"]}],"outputs":[{"name":"pred","desc":"Output prediction.","types":["sf.table.individual"]}]},{"domain":"ml.predict","name":"ss_sgd_predict","desc":"Predict using the SS-SGD model.","version":"0.0.1","attrs":[{"name":"batch_size","desc":"The number of training examples utilized in one iteration.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"1024"},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"receiver","desc":"Party of receiver.","type":"AT_STRING","atomic":{}},{"name":"pred_name","desc":"Column name for predictions.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"pred"}}},{"name":"save_ids","desc":"Whether to save ids columns into output prediction table. If true, input feature_dataset must contain id columns, and receiver party must be id owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"save_label","desc":"Whether or not to save real label columns into output pred file. If true, input feature_dataset must contain label columns and receiver party must be label owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}}],"inputs":[{"name":"model","desc":"Input model.","types":["sf.model.ss_sgd"]},{"name":"feature_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"]}],"outputs":[{"name":"pred","desc":"Output prediction.","types":["sf.table.individual"]}]},{"domain":"ml.predict","name":"ss_xgb_predict","desc":"Predict using the SS-XGB model.","version":"0.0.1","attrs":[{"name":"receiver","desc":"Party of receiver.","type":"AT_STRING","atomic":{}},{"name":"pred_name","desc":"Column name for predictions.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"pred"}}},{"name":"save_ids","desc":"Whether to save ids columns into output prediction table. If true, input feature_dataset must contain id columns, and receiver party must be id owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"save_label","desc":"Whether or not to save real label columns into output pred file. If true, input feature_dataset must contain label columns and receiver party must be label owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}}],"inputs":[{"name":"model","desc":"Input model.","types":["sf.model.ss_xgb"]},{"name":"feature_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"saved_features","desc":"Features to save into output pred file.","colMinCntInclusive":"1"}]}],"outputs":[{"name":"pred","desc":"Output prediction.","types":["sf.table.individual"]}]},{"domain":"ml.train","name":"sgb_train","desc":"Provides both classification and regression tree boosting (also known as GBDT, GBM)\\nfor vertical split dataset setting by using secure boost.\\n- SGB is short for SecureBoost. Compared to its safer counterpart SS-XGB, SecureBoost focused on protecting label holder.\\n- Check https://arxiv.org/abs/1901.08755.","version":"0.0.1","attrs":[{"name":"num_boost_round","desc":"Number of boosting iterations.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true}},{"name":"max_depth","desc":"Maximum depth of a tree.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"5"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"i64":"16"},"upperBoundInclusive":true}},{"name":"learning_rate","desc":"Step size shrinkage used in update to prevent overfitting.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"objective","desc":"Specify the learning objective.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"logistic"},"allowedValues":{"ss":["linear","logistic"]}}},{"name":"reg_lambda","desc":"L2 regularization term on weights.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":10000},"upperBoundInclusive":true}},{"name":"gamma","desc":"Greater than 0 means pre-pruning enabled. If gain of a node is less than this value, it would be pruned.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":10000},"upperBoundInclusive":true}},{"name":"colsample_by_tree","desc":"Subsample ratio of columns when constructing each tree.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"sketch_eps","desc":"This roughly translates into O(1 / sketch_eps) number of bins.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"base_score","desc":"The initial prediction score of all instances, global bias.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"seed","desc":"Pseudorandom number generator seed.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"42"},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"fixed_point_parameter","desc":"Any floating point number encoded by heu, will multiply a scale and take the round, scale = 2 ** fixed_point_parameter. larger value may mean more numerical accuracy, but too large will lead to overflow problem.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"20"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"i64":"100"},"upperBoundInclusive":true}},{"name":"first_tree_with_label_holder_feature","desc":"Whether to train the first tree with label holder's own features.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"batch_encoding_enabled","desc":"If use batch encoding optimization.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{"b":true}}},{"name":"enable_quantization","desc":"Whether enable quantization of g and h.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"quantization_scale","desc":"Scale the sum of g to the specified value.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":10000},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":10000000},"upperBoundInclusive":true}},{"name":"max_leaf","desc":"Maximum leaf of a tree. Only effective if train leaf wise.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"15"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"i64":"32768"},"upperBoundInclusive":true}},{"name":"rowsample_by_tree","desc":"Row sub sample ratio of the training instances.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"enable_goss","desc":"Whether to enable GOSS.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"top_rate","desc":"GOSS-specific parameter. The fraction of large gradients to sample.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.3},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"bottom_rate","desc":"GOSS-specific parameter. The fraction of small gradients to sample.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.5},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"early_stop_criterion_g_abs_sum","desc":"If sum(abs(g)) is lower than or equal to this threshold, training will stop.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"early_stop_criterion_g_abs_sum_change_ratio","desc":"If absolute g sum change ratio is lower than or equal to this threshold, training will stop.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"tree_growing_method","desc":"How to grow tree?","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"level"}}}],"inputs":[{"name":"train_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"label","desc":"Label of train dataset.","colMinCntInclusive":"1","colMaxCntInclusive":"1"},{"name":"feature_selects","desc":"Features to be trained with.","colMinCntInclusive":"1"}]}],"outputs":[{"name":"output_model","desc":"Output model.","types":["sf.model.sgb"]}]},{"domain":"ml.train","name":"ss_glm_train","desc":"generalized linear model (GLM) is a flexible generalization of ordinary linear regression.\\nThe GLM generalizes linear regression by allowing the linear model to be related to the response\\nvariable via a link function and by allowing the magnitude of the variance of each measurement to\\nbe a function of its predicted value.","version":"0.0.1","attrs":[{"name":"epochs","desc":"The number of complete pass through the training data.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true}},{"name":"learning_rate","desc":"The step size at each iteration in one iteration.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"batch_size","desc":"The number of training examples utilized in one iteration.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"1024"},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"link_type","desc":"link function type","type":"AT_STRING","atomic":{"allowedValues":{"ss":["Logit","Log","Reciprocal","Indentity"]}}},{"name":"label_dist_type","desc":"label distribution type","type":"AT_STRING","atomic":{"allowedValues":{"ss":["Bernoulli","Poisson","Gamma","Tweedie"]}}},{"name":"tweedie_power","desc":"Tweedie distribution power parameter","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":1},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":2},"upperBoundInclusive":true}},{"name":"dist_scale","desc":"A guess value for distribution's scale","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":1},"lowerBoundEnabled":true,"lowerBound":{"f":1},"lowerBoundInclusive":true}},{"name":"eps","desc":"If the change rate of weights is less than this threshold, the model is considered to be converged, and the training stops early. 0 to disable.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.0001},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"iter_start_irls","desc":"run a few rounds of IRLS training as the initialization of w, 0 disable","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"decay_epoch","desc":"decay learning interval","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"decay_rate","desc":"decay learning rate","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":1}}},{"name":"optimizer","desc":"which optimizer to use: IRLS(Iteratively Reweighted Least Squares) or SGD(Stochastic Gradient Descent)","type":"AT_STRING","atomic":{"allowedValues":{"ss":["SGD","IRLS"]}}},{"name":"offset_col","desc":"Specify a column to use as the offset","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"weight_col","desc":"Specify a column to use for the observation weights","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{}}}],"inputs":[{"name":"train_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"label","desc":"Label of train dataset.","colMinCntInclusive":"1","colMaxCntInclusive":"1"},{"name":"feature_selects","desc":"Features to be trained with.","colMinCntInclusive":"1"}]}],"outputs":[{"name":"output_model","desc":"Output model.","types":["sf.model.ss_glm"]},{"name":"output_report","desc":"Output report.","types":["sf.report"]}]},{"domain":"ml.train","name":"ss_sgd_train","desc":"Train both linear and logistic regression\\nlinear models for vertical partitioning dataset with mini batch SGD training solver by using secret sharing.\\n- SS-SGD is short for secret sharing SGD training.","version":"0.0.1","attrs":[{"name":"epochs","desc":"The number of complete pass through the training data.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true}},{"name":"learning_rate","desc":"The step size at each iteration in one iteration.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"batch_size","desc":"The number of training examples utilized in one iteration.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"1024"},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"sig_type","desc":"Sigmoid approximation type.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"t1"},"allowedValues":{"ss":["real","t1","t3","t5","df","sr","mix"]}}},{"name":"reg_type","desc":"Regression type","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"logistic"},"allowedValues":{"ss":["linear","logistic"]}}},{"name":"penalty","desc":"The penalty(aka regularization term) to be used.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"None"},"allowedValues":{"ss":["None","l1","l2"]}}},{"name":"l2_norm","desc":"L2 regularization term.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.5},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"eps","desc":"If the change rate of weights is less than this threshold, the model is considered to be converged, and the training stops early. 0 to disable.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.001},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}}],"inputs":[{"name":"train_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"label","desc":"Label of train dataset.","colMinCntInclusive":"1","colMaxCntInclusive":"1"},{"name":"feature_selects","desc":"Features to be trained with.","colMinCntInclusive":"1"}]}],"outputs":[{"name":"output_model","desc":"Output model.","types":["sf.model.ss_sgd"]}]},{"domain":"ml.train","name":"ss_xgb_train","desc":"This method provides both classification and regression tree boosting (also known as GBDT, GBM)\\nfor vertical partitioning dataset setting by using secret sharing.\\n- SS-XGB is short for secret sharing XGB.\\n- More details: https://arxiv.org/pdf/2005.08479.pdf","version":"0.0.1","attrs":[{"name":"num_boost_round","desc":"Number of boosting iterations.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true}},{"name":"max_depth","desc":"Maximum depth of a tree.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"5"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"i64":"16"},"upperBoundInclusive":true}},{"name":"learning_rate","desc":"Step size shrinkage used in updates to prevent overfitting.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"objective","desc":"Specify the learning objective.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"logistic"},"allowedValues":{"ss":["linear","logistic"]}}},{"name":"reg_lambda","desc":"L2 regularization term on weights.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":10000},"upperBoundInclusive":true}},{"name":"subsample","desc":"Subsample ratio of the training instances.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"colsample_by_tree","desc":"Subsample ratio of columns when constructing each tree.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"sketch_eps","desc":"This roughly translates into O(1 / sketch_eps) number of bins.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"base_score","desc":"The initial prediction score of all instances, global bias.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"seed","desc":"Pseudorandom number generator seed.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"42"},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}}],"inputs":[{"name":"train_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"feature_selects","desc":"Features to be trained with.","colMinCntInclusive":"1"},{"name":"label","desc":"Label of train dataset.","colMinCntInclusive":"1","colMaxCntInclusive":"1"}]}],"outputs":[{"name":"output_model","desc":"Output model.","types":["sf.model.ss_xgb"]}]},{"domain":"data_filter","name":"feature_filter","desc":"Drop features from the dataset.","version":"0.0.1","inputs":[{"name":"in_ds","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"drop_features","desc":"Features to drop."}]}],"outputs":[{"name":"out_ds","desc":"Output vertical table.","types":["sf.table.vertical_table"]}]},{"domain":"data_prep","name":"psi","desc":"PSI between two parties.","version":"0.0.1","attrs":[{"name":"protocol","desc":"PSI protocol.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"ECDH_PSI_2PC"},"allowedValues":{"ss":["ECDH_PSI_2PC","KKRT_PSI_2PC","BC22_PSI_2PC"]}}},{"name":"sort","desc":"Sort the output.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"bucket_size","desc":"Specify the hash bucket size used in PSI. Larger values consume more memory.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"1048576"},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"ecdh_curve_type","desc":"Curve type for ECDH PSI.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"CURVE_FOURQ"},"allowedValues":{"ss":["CURVE_25519","CURVE_FOURQ","CURVE_SM2","CURVE_SECP256K1"]}}}],"inputs":[{"name":"receiver_input","desc":"Individual table for receiver","types":["sf.table.individual"],"attrs":[{"name":"key","desc":"Column(s) used to join.","colMinCntInclusive":"1"}]},{"name":"sender_input","desc":"Individual table for sender","types":["sf.table.individual"],"attrs":[{"name":"key","desc":"Column(s) used to join.","colMinCntInclusive":"1"}]}],"outputs":[{"name":"psi_output","desc":"Output vertical table","types":["sf.table.vertical_table"]}]},{"domain":"data_prep","name":"train_test_split","desc":"Split datasets into random train and test subsets.\\n- Please check: https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html","version":"0.0.1","attrs":[{"name":"train_size","desc":"Proportion of the dataset to include in the train subset.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.75},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"test_size","desc":"Proportion of the dataset to include in the test subset.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.25},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"random_state","desc":"Specify the random seed of the shuffling.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"1024"},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"shuffle","desc":"Whether to shuffle the data before splitting.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{"b":true}}}],"inputs":[{"name":"input_data","desc":"Input vertical table.","types":["sf.table.vertical_table"]}],"outputs":[{"name":"train","desc":"Output train dataset.","types":["sf.table.vertical_table"]},{"name":"test","desc":"Output test dataset.","types":["sf.table.vertical_table"]}]},{"domain":"stats","name":"groupby_statistics","desc":"Get a groupby of statistics, like pandas groupby statistics.\\nCurrently only support VDataframe.","version":"0.0.1","attrs":[{"name":"agg","desc":"What kind of aggregation statistics we want to do, currently only supports min, max, mean, sum, var, count(number of elements in each group)","type":"AT_STRING","atomic":{"allowedValues":{"ss":["min","max","mean","sum","var","count"]}}},{"name":"max_group_size","desc":"The maximum number of groups allowed","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10000"},"lowerBoundEnabled":true,"lowerBound":{}}}],"inputs":[{"name":"input_data","desc":"Input table.","types":["sf.table.vertical_table","sf.table.individual"],"attrs":[{"name":"by","desc":"by what columns should we group the values","colMinCntInclusive":"1","colMaxCntInclusive":"4"},{"name":"values","desc":"on which columns should we calculate the statistics","colMinCntInclusive":"1"}]}],"outputs":[{"name":"report","desc":"Output groupby statistics report.","types":["sf.report"]}]},{"domain":"stats","name":"ss_pearsonr","desc":"Calculate Pearson's product-moment correlation coefficient for vertical partitioning dataset\\nby using secret sharing.\\n- For large dataset(large than 10w samples & 200 features), recommend to use [Ring size: 128, Fxp: 40] options for SPU device.","version":"0.0.1","inputs":[{"name":"input_data","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"feature_selects","desc":"Specify which features to calculate correlation coefficient with. If empty, all features will be used"}]}],"outputs":[{"name":"report","desc":"Output Pearson's product-moment correlation coefficient report.","types":["sf.report"]}]},{"domain":"stats","name":"ss_vif","desc":"Calculate Variance Inflation Factor(VIF) for vertical partitioning dataset\\nby using secret sharing.\\n- For large dataset(large than 10w samples & 200 features), recommend to use [Ring size: 128, Fxp: 40] options for SPU device.","version":"0.0.1","inputs":[{"name":"input_data","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"feature_selects","desc":"Specify which features to calculate VIF with. If empty, all features will be used."}]}],"outputs":[{"name":"report","desc":"Output Variance Inflation Factor(VIF) report.","types":["sf.report"]}]},{"domain":"stats","name":"table_statistics","desc":"Get a table of statistics,\\nincluding each column's\\n1. datatype\\n2. total_count\\n3. count\\n4. count_na\\n5. min\\n6. max\\n7. var\\n8. std\\n9. sem\\n10. skewness\\n11. kurtosis\\n12. q1\\n13. q2\\n14. q3\\n15. moment_2\\n16. moment_3\\n17. moment_4\\n18. central_moment_2\\n19. central_moment_3\\n20. central_moment_4\\n21. sum\\n22. sum_2\\n23. sum_3\\n24. sum_4\\n- moment_2 means E[X^2].\\n- central_moment_2 means E[(X - mean(X))^2].\\n- sum_2 means sum(X^2).","version":"0.0.1","inputs":[{"name":"input_data","desc":"Input table.","types":["sf.table.vertical_table","sf.table.individual"]}],"outputs":[{"name":"report","desc":"Output table statistics report.","types":["sf.report"]}]}]}`),la=function(a){var n=[],r=(0,wt.Z)(a,"domain");return Object.keys(r).forEach(function(e){var t=r[e],i={value:e,label:e,children:[]},s=(0,wt.Z)(t,"name");Object.keys(s).forEach(function(o){var l=s[o],y={value:o,label:o,children:[]};l.forEach(function(p){y.children.push({value:p.version,label:p.version,component:p,children:[]})}),i.children.push(y)}),n.push(i)}),n},ua=la(kt.$9),ca=function(a){var n=ae()(a,3),r=n[0],e=n[1],t=n[2],i=kt.$9.find(function(s){return s.domain===r&&s.name===e&&s.version===t});return i},da=function(a){return[a.domain,a.name,a.version]},pa=function(a){var n=a.component,r=a.onComponentChange;return(0,u.jsx)(De.Z,{popupClassName:"component-cascader",size:"small",options:ua,value:n?[n.domain,n.name,n.version]:[],onChange:function(t,i){var s,o=i==null||(s=i[i.length-1])===null||s===void 0?void 0:s.component;o&&r&&r(o)},placeholder:"Please select a component first."})},St=(0,N.forwardRef)(function(c,a){var n=c.component,r=c.onComponentChange,e=c.defaultComponentConfig,t=c.onComponentConfigChange,i=c.outputs,s=c.report,o=c.loading,l=(0,N.useMemo)(function(){var m=[];return i.forEach(function(C){C.output_type==="stream"?C.text&&m.push(C.text):C.output_type==="error"&&C.traceback&&m.push(C.traceback.join(""))}),(0,u.jsx)(qr.default,{code:m,theme:"light"})},[i]),y=s?[{key:"1",label:"report.name",children:s.name},{key:"2",label:"report.meta.name",children:s.metaName},{key:"3",label:"report.meta.desc",children:s.metaDesc}]:[],p=s?[{title:"",dataIndex:"$key",key:-1,rowScope:"row"}].concat(Be()(s.metaColumnNames.map(function(m,C){return{title:m,dataIndex:m,key:m}}))):[],h=s?function(){for(var m=[],C=function(k){var F={$key:s.metaRowNames[k]};s.metaColumnNames.forEach(function(z,H){F[z]=Object.values(s.metaRowItems[k][H])[0]}),m.push(j()({},F))},A=0;A<s.metaRowItems.length;A++)C(A);return m}():[],b=[{key:"1",label:"Log",children:(0,u.jsx)("div",{className:"sf-component-log",children:o?(0,u.jsx)("div",{className:"loading",children:(0,u.jsx)(V.Z,{})}):l})},{key:"2",label:"Report",children:(0,u.jsx)("div",{className:"sf-component-report",children:s?(0,u.jsxs)("div",{children:[(0,u.jsx)(T.Z,{items:y}),(0,u.jsx)(D.Z,{columns:p,dataSource:h,pagination:!1,virtual:!0})]}):(0,u.jsx)(Z.Z,{image:Z.Z.PRESENTED_IMAGE_SIMPLE,description:"No report."})})}];return(0,u.jsxs)("div",{className:"component-cell-container",children:[(0,u.jsxs)("div",{className:"header",children:[(0,u.jsx)("span",{children:"component:"}),(0,u.jsx)(pa,{component:n,onComponentChange:function(C){r&&r(C)}})]}),(0,u.jsxs)("div",{className:"body",children:[(0,u.jsx)("div",{className:"config",children:n?(0,u.jsx)(gt,{config:n,ref:a,defaultValue:e,onValuesChange:t}):(0,u.jsx)(Z.Z,{image:Z.Z.PRESENTED_IMAGE_SIMPLE,description:"Select a component first.",style:{marginTop:120}})}),(0,u.jsx)("div",{className:"result",children:(0,u.jsx)(J.Z,{defaultActiveKey:"1",items:b,size:"small"})})]})]})});St.displayName="CellComponent";var Tt,Ot,Bt,It,At,Nt,Mt,xt,Et,jt,Vt,Rt,_t,Ft,re,Ee,Pt,Lt,Kt,zt,Dt=(0,N.forwardRef)(function(c,a){var n=(0,E.oC)(me.yd);return(0,u.jsx)("div",{tabIndex:10,ref:a,className:"sf-component-container",onFocus:function(){n.focus(!0)},onBlur:function(e){var t;typeof a!="function"&&!(a!=null&&(t=a.current)!==null&&t!==void 0&&t.contains(e.relatedTarget))&&n.blur()},children:(0,u.jsx)(St,{loading:n.launching,outputs:n.cellModel.outputs,report:n.cellModel.report,component:n.component,onComponentChange:function(e){n.onComponentChange(e)},defaultComponentConfig:n.defaultComponentConfig,onComponentConfigChange:function(e,t){n.onComponentConfigChange(t)}})})});Dt.displayName="SFComponentCellComponent";var Zt=(Tt=(0,I.H3)(),Ot=(0,Ie.ei)("sf-component-cell-view"),Bt=function(a,n){return(0,I.f3)(me.Hj)(a,void 0,0)},It=function(a,n){return(0,I.f3)(g.xxA)(a,void 0,1)},At=function(a,n){return(0,I.f3)(ve.H)(a,void 0,2)},Nt=Reflect.metadata("design:type",Function),Mt=Reflect.metadata("design:paramtypes",[typeof CellViewOptions=="undefined"?Object:CellViewOptions,typeof g.xxA=="undefined"?Object:g.xxA,typeof ve.H=="undefined"?Object:ve.H]),xt=(0,E.vg)(),Et=Reflect.metadata("design:type",typeof ComponentSpec=="undefined"?Object:ComponentSpec),jt=(0,E.vg)(),Vt=Reflect.metadata("design:type",typeof Value=="undefined"?Object:Value),Rt=(0,E.vg)(),_t=Reflect.metadata("design:type",typeof Value=="undefined"?Object:Value),Ft=(0,E.vg)(),Tt(re=Ot(re=Bt(re=It(re=At(re=Nt(re=Mt(re=(Ee=function(c){pe()(n,c);var a=fe()(n);function n(r,e,t){var i;return Q()(this,n),i=a.call(this,r,e),S()(w()(i),"view",Dt),S()(w()(i),"commandRegistry",void 0),S()(w()(i),"outputArea",{outputs:[]}),G()(w()(i),"component",Pt,w()(i)),G()(w()(i),"componentConfigValue",Lt,w()(i)),G()(w()(i),"defaultComponentConfig",Kt,w()(i)),G()(w()(i),"launching",zt,w()(i)),S()(w()(i),"onComponentChange",function(s){i.component=s,i.componentConfigValue={},i.cellModel.outputs=[],i.cellModel.metadata.component={id:da(s),params:{}},i.cellModel.outputs=[]}),S()(w()(i),"onComponentConfigChange",function(s){i.componentConfigValue=s;var o=i.cellModel.metadata;o&&o.component&&(o.component.params=s),i.save()}),i.commandRegistry=t,i}return q()(n,[{key:"cellModel",get:function(){return this.model}},{key:"onViewMount",value:function(){var e=this.cellModel.metadata;if(e.component){var t=e.component,i=t.id,s=t.params;this.component=ca(i),this.defaultComponentConfig=s,this.componentConfigValue=s}}},{key:"save",value:function(){this.commandRegistry.executeCommand(g.Xa6.Save.id)}},{key:"run",value:function(){var r=O()(f()().mark(function t(){var i=this,s,o,l,y,p,h,b,m,C;return f()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(s=this.getKernelConnections(),s.length!==0){v.next=3;break}return v.abrupt("return",!1);case 3:if(!(!this.component||!this.componentConfigValue)){v.next=6;break}return _.ZP.error(M.U6.t("Please select a component first.")),v.abrupt("return",!1);case 6:for(this.clearExecution(),this.cellModel.outputs=[],v.prev=8,this.cellModel.executing=!0,this.launching=!0,o=[],l=0,y=s.length;l<y;l+=1)p=s[l],h=p.requestExecute({code:Ct(this.component,this.componentConfigValue)}),h.onIOPub=function(k){i.handleMessages(k),k.header.msg_type==="execute_input"&&(i.cellModel.kernelExecuting=!0)},h.onReply=function(k){i.handleMessages(k)},o.push(h.done);return v.next=15,Promise.all(o);case 15:if(b=v.sent,this.cellModel.kernelExecuting=!1,this.cellModel.executing=!1,m=b.every(function(k){return k.content.status==="ok"}),!m){v.next=24;break}return this.save(),v.abrupt("return",!0);case 24:if(C=b.find(function(k){return k.content.status!=="ok"}),!C){v.next=27;break}throw new g.e__(C.content);case 27:return v.abrupt("return",!1);case 28:v.next=35;break;case 30:if(v.prev=30,v.t0=v.catch(8),!(v.t0 instanceof Error&&v.t0.message.startsWith("Canceled"))){v.next=34;break}return v.abrupt("return",!1);case 34:throw v.t0;case 35:return v.prev=35,this.launching=!1,v.finish(35);case 38:case"end":return v.stop()}},t,this,[[8,30,35,38]])}));function e(){return r.apply(this,arguments)}return e}()},{key:"getKernelConnections",value:function(){var e=this.parent.model;return e?(0,E.P$)(e.kernelConnections):[]}},{key:"handleMessages",value:function(e){if(this.launching=!1,(0,g.HXF)(e)||(0,g.aL4)(e)){var t=j()(j()({},e.content),{},{output_type:e.header.msg_type});this.cellModel.outputs=[].concat(Be()(this.cellModel.outputs),[t])}if((0,g.TuP)(e)){var i;if(((i=e.content.data)===null||i===void 0?void 0:i.$type)==="component-cell.result"){var s,o=JSON.parse(((s=e.content.data)===null||s===void 0?void 0:s.payload)||"{}"),l=o.outputs.filter(function(m){return m.type==="sf.report"});if(l.length){var y,p=l[0],h=((y=p.meta)===null||y===void 0||(y=y.tabs)===null||y===void 0||(y=y[0])===null||y===void 0||(y=y.divs)===null||y===void 0||(y=y[0])===null||y===void 0||(y=y.children)===null||y===void 0?void 0:y[0])||{},b={name:p.name,metaName:p.meta.name,metaDesc:p.meta.desc};h.type==="table"?this.cellModel.report=j()(j()({},b),{},{metaColumnNames:h.table.headers.map(function(m){return m.name}),metaRowNames:h.table.rows.map(function(m){return m.name}),metaRowItems:h.table.rows.map(function(m){return m.items})}):h.type==="descriptions"?this.cellModel.report=j()(j()({},b),{},{metaColumnNames:["value"],metaRowNames:h.descriptions.items.map(function(m){return m.name}),metaRowItems:h.descriptions.items.map(function(m){return[m.value]})}):this.cellModel.report=j()(j()({},b),{},{metaColumnNames:[],metaRowNames:[],metaRowItems:[]})}}}}},{key:"toJSON",value:function(){var e=this.component&&this.componentConfigValue?Ct(this.component,this.componentConfigValue):"";return{id:this.cellModel.id,cell_type:"component",source:e,metadata:this.cellModel.metadata,outputs:this.cellModel.outputs,report:this.cellModel.report}}},{key:"focus",value:function(e){e&&(this.cellModel.isEdit=!0)}},{key:"blur",value:function(){this.cellModel.isEdit=!1}},{key:"shouldEnterEditorMode",value:function(){return this.cellModel.isEdit}}]),n}(g.XCr),Pt=x()(Ee.prototype,"component",[xt,Et],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lt=x()(Ee.prototype,"componentConfigValue",[jt,Vt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kt=x()(Ee.prototype,"defaultComponentConfig",[Rt,_t],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zt=x()(Ee.prototype,"launching",[Ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ee))||re)||re)||re)||re)||re)||re)||re),Gt,Ut,$t,Ht,we,fa=(Gt=(0,I.ri)({contrib:[g.SqL,g.GDy]}),Ut=function(a,n){return(0,I.f3)(Me)(a,void 0,0)},$t=Reflect.metadata("design:type",Function),Ht=Reflect.metadata("design:paramtypes",[typeof Me=="undefined"?Object:Me]),Gt(we=Ut(we=$t(we=Ht(we=function(){function c(a){Q()(this,c),S()(this,"modelFactory",void 0),S()(this,"cellMeta",{type:"component",name:"Component",order:"c",nbformatType:"raw"}),S()(this,"view",Zt),this.modelFactory=a}return q()(c,[{key:"canHandle",value:function(n,r){return r===this.cellMeta.type?1e3:-1}},{key:"createModel",value:function(){var a=O()(f()().mark(function r(e){var t;return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=this.modelFactory(e),s.abrupt("return",t);case 2:case"end":return s.stop()}},r,this)}));function n(r){return a.apply(this,arguments)}return n}()}]),c}())||we)||we)||we)||we),ma=d(79239),Wt,Jt,Xt,Yt,Qt,qt,en,tn,nn,rn,an,sn,on,ln,un,cn,dn,ke,ye,pn,fn,mn,vn,hn,gn,yn,bn=(Wt=(0,I.H3)(),Jt=function(a,n){return(0,I.f3)(g.seq)(a,void 0,0)},Xt=Reflect.metadata("design:type",Function),Yt=Reflect.metadata("design:paramtypes",[typeof g.seq=="undefined"?Object:g.seq]),Qt=(0,E.vg)(),qt=(0,E.vg)(),en=Reflect.metadata("design:type",Boolean),tn=(0,E.vg)(),nn=Reflect.metadata("design:type",Boolean),rn=(0,E.vg)(),an=Reflect.metadata("design:type",typeof ExecutionCount=="undefined"?Object:ExecutionCount),sn=(0,E.vg)(),on=Reflect.metadata("design:type",typeof Partial=="undefined"?Object:Partial),ln=(0,E.vg)(),un=Reflect.metadata("design:type",Array),cn=(0,E.vg)(),dn=Reflect.metadata("design:type",typeof ComponentReport=="undefined"?Object:ComponentReport),Wt(ke=Jt(ke=Xt(ke=Yt(ke=(ye=function(c){pe()(n,c);var a=fe()(n);function n(r){var e;return Q()(this,n),e=a.call(this,r),S()(w()(e),"mimeType","application/vnd.libro.component+json"),S()(w()(e),"hasOutputHidden",!1),S()(w()(e),"hasOutputsScrolled",!1),G()(w()(e),"isEdit",pn,w()(e)),G()(w()(e),"executing",fn,w()(e)),G()(w()(e),"kernelExecuting",mn,w()(e)),G()(w()(e),"executeCount",vn,w()(e)),S()(w()(e),"msgChangeEmitter",void 0),G()(w()(e),"metadata",hn,w()(e)),G()(w()(e),"outputs",gn,w()(e)),G()(w()(e),"report",yn,w()(e)),e.executing=!1,e.kernelExecuting=!1,e.msgChangeEmitter=new ma.Q5,e.metadata=r.cell.metadata||{},e.outputs=r.cell.outputs||[],e.report=r.cell.report||null,e.value=(0,g.XaW)(r.cell.source),e}return q()(n,[{key:"msgChange",get:function(){return this.msgChangeEmitter.event}},{key:"clearExecution",value:function(){this.metadata={},this.outputs=[],this.executing=!1,this.kernelExecuting=!1,this.executeCount=null}}]),n}(g.KZ9),pn=x()(ye.prototype,"isEdit",[Qt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),fn=x()(ye.prototype,"executing",[qt,en],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mn=x()(ye.prototype,"kernelExecuting",[tn,nn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vn=x()(ye.prototype,"executeCount",[rn,an],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),hn=x()(ye.prototype,"metadata",[sn,on],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gn=x()(ye.prototype,"outputs",[ln,un],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),yn=x()(ye.prototype,"report",[cn,dn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ye))||ke)||ke)||ke)||ke),va=Oe.R.create().register(fa,Zt,bn,{token:Me,useFactory:function(a){return function(n){var r=a.container.createChild();r.register({token:g.seq,useValue:n});var e=r.get(bn);return e}}}),Ze=d(72085),ha=d(7146),ct=d(73997),U=d(86038),Cn,wn,kn,Sn,Tn,On,Bn,In,X,ie=(Cn=(0,I.ri)(),wn=function(a,n){return(0,I.f3)(g.oeX)(a,void 0,0)},kn=function(a,n){return(0,I.f3)(g.frY)(a,void 0,1)},Sn=function(a,n){return(0,I.f3)(U.CP)(a,void 0,2)},Tn=function(a,n){return(0,I.f3)(g.pv1)(a,void 0,3)},On=function(a,n){return(0,I.f3)(ct.V)(a,void 0,4)},Bn=Reflect.metadata("design:type",Function),In=Reflect.metadata("design:paramtypes",[typeof g.oeX=="undefined"?Object:g.oeX,typeof g.frY=="undefined"?Object:g.frY,typeof U.CP=="undefined"?Object:U.CP,typeof g.pv1=="undefined"?Object:g.pv1,typeof ct.V=="undefined"?Object:ct.V]),Cn(X=wn(X=kn(X=Sn(X=Tn(X=On(X=Bn(X=In(X=function(){function c(a,n,r,e,t){Q()(this,c),S()(this,"file2KernelConnections",new Map),S()(this,"kernelConnection2Server",new Map),S()(this,"sessionRestAPI",void 0),S()(this,"kernelRestAPI",void 0),S()(this,"kernelConnectionFactory",void 0),S()(this,"serverManager",void 0),S()(this,"storageService",void 0),this.sessionRestAPI=a,this.kernelRestAPI=n,this.kernelConnectionFactory=e,this.serverManager=r,this.storageService=t}return q()(c,[{key:"createKernelConnections",value:function(){var a=O()(f()().mark(function r(e){var t=this,i,s,o,l,y,p;return f()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.serverManager.getServerList();case 2:return i=b.sent.filter(function(m){return m.status==="running"}),s=[],b.next=6,this.storageService.getData(this.storedKey(e),[]);case 6:o=b.sent,l=f()().mark(function m(){var C,A,v,k,F,z;return f()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(C=i[y],A=o.find(function(L){return L.serverId===C.id}),!A){P.next=21;break}return k=A.options,F=k.model.id,P.next=7,t.isKernelAlive(F,C);case 7:if(z=P.sent,!z){P.next=14;break}return P.next=11,t.connectToKernel(j()(j()({},k),{},{serverSettings:{baseUrl:(0,B.KP)(C.id),wsUrl:(0,B.Vq)(C.id)}}));case 11:v=P.sent,P.next=19;break;case 14:return P.next=16,t.removeStoredSession(e,A);case 16:return P.next=18,t.createKernelConnection(e,C);case 18:v=P.sent;case 19:P.next=24;break;case 21:return P.next=23,t.createKernelConnection(e,C);case 23:v=P.sent;case 24:v&&(s.push(v),t.kernelConnection2Server.set(v.id,C.id));case 25:case"end":return P.stop()}},m)}),y=0,p=i.length;case 9:if(!(y<p)){b.next=14;break}return b.delegateYield(l(),"t0",11);case 11:y++,b.next=9;break;case 14:return this.file2KernelConnections.set(this.storedKey(e),s),b.abrupt("return",s);case 16:case"end":return b.stop()}},r,this)}));function n(r){return a.apply(this,arguments)}return n}()},{key:"addKernelConnectionOnServer",value:function(){var a=O()(f()().mark(function r(e,t){var i,s;return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.createKernelConnection(e,t);case 2:i=l.sent,i&&(this.kernelConnection2Server.set(i.id,t.id),s=this.file2KernelConnections.get(this.storedKey(e))||[],this.file2KernelConnections.set(this.storedKey(e),[].concat(Be()(s),[i])));case 4:case"end":return l.stop()}},r,this)}));function n(r,e){return a.apply(this,arguments)}return n}()},{key:"deleteKernelConnectionOnServer",value:function(){var a=O()(f()().mark(function r(e,t){var i=this,s,o,l,y,p;return f()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.storageService.getData(this.storedKey(e),[]);case 2:if(s=b.sent,o=s.find(function(m){return m.serverId===t.id}),!o){b.next=7;break}return b.next=7,this.removeStoredSession(e,o);case 7:l=this.file2KernelConnections.get(this.storedKey(e)),l&&(y=[],l.forEach(function(m){var C=i.getServerByKernelConnection(m);C&&C.id===t.id&&(i.kernelConnection2Server.delete(m.id),m.shutdown(),y.push(m.id))}),p=l.filter(function(m){return!y.includes(m.id)}),this.file2KernelConnections.set(this.storedKey(e),p));case 9:case"end":return b.stop()}},r,this)}));function n(r,e){return a.apply(this,arguments)}return n}()},{key:"shutdownKernelConnections",value:function(){var a=O()(f()().mark(function r(e){var t=this,i;return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(i=this.file2KernelConnections.get(this.storedKey(e)),!i){o.next=6;break}return i.forEach(function(l){t.kernelConnection2Server.delete(l.id),l.shutdown()}),o.next=5,this.clearStoredSessions(e);case 5:this.file2KernelConnections.delete(this.storedKey(e));case 6:case"end":return o.stop()}},r,this)}));function n(r){return a.apply(this,arguments)}return n}()},{key:"getKernelConnections",value:function(n){return this.file2KernelConnections.get(this.storedKey(n))||[]}},{key:"getServerByKernelConnection",value:function(n){var r=this.kernelConnection2Server.get(n.id);if(r)return this.serverManager.servers.find(function(e){return e.id===r})}},{key:"createKernelConnection",value:function(){var a=O()(f()().mark(function r(e,t){var i,s,o,l;return f()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return i=this.getDefaultKernelName(e,t),p.next=3,this.sessionRestAPI.startSession({name:e.name,kernel:{kernelName:i},path:e.path,type:e.type},{baseUrl:(0,B.KP)(t.id),wsUrl:(0,B.Vq)(t.id)});case 3:if(s=p.sent,!(!s||!s.kernel)){p.next=6;break}return p.abrupt("return");case 6:return o={model:{id:s.kernel.id,name:s.kernel.name}},p.next=9,this.addStoredSession(e,{sessionId:s.id,serverId:t.id,options:o});case 9:return p.next=11,this.connectToKernel(j()(j()({},o),{},{serverSettings:{baseUrl:(0,B.KP)(t.id),wsUrl:(0,B.Vq)(t.id)}}));case 11:return l=p.sent,p.abrupt("return",l);case 13:case"end":return p.stop()}},r,this)}));function n(r,e){return a.apply(this,arguments)}return n}()},{key:"connectToKernel",value:function(){var a=O()(f()().mark(function r(e){var t;return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=this.kernelConnectionFactory(e),s.abrupt("return",t);case 2:case"end":return s.stop()}},r,this)}));function n(r){return a.apply(this,arguments)}return n}()},{key:"isKernelAlive",value:function(){var a=O()(f()().mark(function r(e,t){var i;return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,this.kernelRestAPI.getKernelModel(e,{baseUrl:(0,B.KP)(t.id),wsUrl:(0,B.Vq)(t.id)});case 3:return i=o.sent,o.abrupt("return",!!i);case 7:return o.prev=7,o.t0=o.catch(0),o.abrupt("return",!1);case 10:case"end":return o.stop()}},r,this,[[0,7]])}));function n(r,e){return a.apply(this,arguments)}return n}()},{key:"storedKey",value:function(n){return"secretnote_".concat(n.path,"_").concat(n.name)}},{key:"addStoredSession",value:function(){var a=O()(f()().mark(function r(e,t){var i;return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.storageService.getData(this.storedKey(e));case 2:return i=o.sent,i?i.push(t):i=[t],o.next=6,this.storageService.setData(this.storedKey(e),i);case 6:case"end":return o.stop()}},r,this)}));function n(r,e){return a.apply(this,arguments)}return n}()},{key:"removeStoredSession",value:function(){var a=O()(f()().mark(function r(e,t){var i;return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.storageService.getData(this.storedKey(e),[]);case 2:return i=o.sent,i=i.filter(function(l){return l.sessionId!==t.sessionId}),o.next=6,this.storageService.setData(this.storedKey(e),i);case 6:case"end":return o.stop()}},r,this)}));function n(r,e){return a.apply(this,arguments)}return n}()},{key:"clearStoredSessions",value:function(){var a=O()(f()().mark(function r(e){return f()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.storageService.setData(this.storedKey(e),void 0);case 2:case"end":return i.stop()}},r,this)}));function n(r){return a.apply(this,arguments)}return n}()},{key:"getDefaultKernelName",value:function(n,r){var e,t,i=((e=n.content.metadata.kernelspec)===null||e===void 0?void 0:e.name)||((t=r.kernelspec)===null||t===void 0?void 0:t.default)||"python3";return i}}]),c}())||X)||X)||X)||X)||X)||X)||X)||X),ga=Oe.R.create().register(ie),An,Nn,Mn,xn,En,jn,Vn,Rn,_n,Fn,Pn,Ln,Kn,Y,je,zn,Dn,Zn,Gn,ya=(An=(0,I.H3)(),Nn=function(a,n){return(0,I.f3)(ie)(a,void 0,0)},Mn=function(a,n){return(0,I.f3)(U.CP)(a,void 0,1)},xn=function(a,n){return(0,I.f3)(g.QY6)(a,void 0,2)},En=function(a,n){return(0,I.f3)(Ze.Z)(a,void 0,3)},jn=function(a,n){return(0,I.f3)(ve.H)(a,void 0,4)},Vn=Reflect.metadata("design:type",Function),Rn=Reflect.metadata("design:paramtypes",[typeof ie=="undefined"?Object:ie,typeof U.CP=="undefined"?Object:U.CP,typeof g.QY6=="undefined"?Object:g.QY6,typeof Ze.Z=="undefined"?Object:Ze.Z,typeof ve.H=="undefined"?Object:ve.H]),_n=(0,E.vg)(),Fn=(0,E.vg)(),Pn=Reflect.metadata("design:type",Array),Ln=(0,E.vg)(),Kn=(0,E.vg)(),An(Y=Nn(Y=Mn(Y=xn(Y=En(Y=jn(Y=Vn(Y=Rn(Y=(je=function(c){pe()(n,c);var a=fe()(n);function n(r,e,t,i,s){var o;return Q()(this,n),o=a.call(this),S()(w()(o),"kernelManager",void 0),S()(w()(o),"serverManager",void 0),S()(w()(o),"modalService",void 0),S()(w()(o),"commandRegistry",void 0),S()(w()(o),"currentFileContents",void 0),S()(w()(o),"contentsManager",void 0),G()(w()(o),"kernelConnecting",zn,w()(o)),G()(w()(o),"kernelConnections",Dn,w()(o)),G()(w()(o),"filePath",Zn,w()(o)),G()(w()(o),"lspEnabled",Gn,w()(o)),S()(w()(o),"autoSave",(0,ha.Z)(function(){o.commandRegistry.executeCommand(g.Xa6.Save.id)},500)),o.kernelManager=r,o.serverManager=e,o.contentsManager=t,o.modalService=i,o.commandRegistry=s,o.serverManager.onServerAdded(o.onServerAdded.bind(w()(o))),o.serverManager.onServerDeleted(o.onServerDeleted.bind(w()(o))),o.onChanged(o.autoSave.bind(w()(o))),o}return q()(n,[{key:"isKernelIdle",get:function(){return this.kernelConnections.every(function(e){return e.status==="idle"})}},{key:"kernelConnection",get:function(){return this.kernelConnections[0]}},{key:"startKernelConnection",value:function(){var r=O()(f()().mark(function t(){var i,s;return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this.kernelConnecting=!0,i=this.currentFileContents,i){l.next=4;break}return l.abrupt("return");case 4:if(s=this.kernelManager.getKernelConnections(i),!(s.length>0)){l.next=10;break}this.kernelConnections=s,this.kernelConnecting=!1,l.next=14;break;case 10:return l.next=12,this.kernelManager.createKernelConnections(i);case 12:this.kernelConnections=l.sent,this.kernelConnecting=!1;case 14:case"end":return l.stop()}},t,this)}));function e(){return r.apply(this,arguments)}return e}()},{key:"saveNotebookContent",value:function(){var r=O()(f()().mark(function t(){var i,s,o,l;return f()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(i=this.toJSON(),this.currentFileContents){p.next=3;break}throw new Error("currentFileContents is undefined");case 3:return p.prev=3,p.next=6,this.contentsManager.save(this.currentFileContents.path,{type:this.currentFileContents.type,content:i,format:this.currentFileContents.format,baseUrl:(0,B.Ue)()});case 6:if(s=p.sent,s){p.next=9;break}return p.abrupt("return");case 9:if(!(s.last_modified===this.currentFileContents.last_modified||s.size===0)){p.next=13;break}throw l="File Save Error: ".concat((o=s)===null||o===void 0?void 0:o.message),this.modalService.openModal(g.l6J),new Error(l);case 13:p.next=21;break;case 15:if(p.prev=15,p.t0=p.catch(3),s){p.next=19;break}return p.abrupt("return");case 19:throw this.modalService.openModal(g.l6J),new Error("File Save Error");case 21:return p.next=23,this.createCheckpoint();case 23:case"end":return p.stop()}},t,this,[[3,15]])}));function e(){return r.apply(this,arguments)}return e}()},{key:"onServerAdded",value:function(){var r=O()(f()().mark(function t(i){return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!this.currentFileContents){o.next=6;break}return o.next=3,this.kernelManager.addKernelConnectionOnServer(this.currentFileContents,i);case 3:return o.next=5,this.kernelManager.createKernelConnections(this.currentFileContents);case 5:this.kernelConnections=o.sent;case 6:case"end":return o.stop()}},t,this)}));function e(t){return r.apply(this,arguments)}return e}()},{key:"onServerDeleted",value:function(){var r=O()(f()().mark(function t(i){return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!this.currentFileContents){o.next=6;break}return o.next=3,this.kernelManager.deleteKernelConnectionOnServer(this.currentFileContents,i);case 3:return o.next=5,this.kernelManager.createKernelConnections(this.currentFileContents);case 5:this.kernelConnections=o.sent;case 6:case"end":return o.stop()}},t,this)}));function e(t){return r.apply(this,arguments)}return e}()},{key:"canRun",value:function(){return!0}},{key:"interrupt",value:function(){var r=O()(f()().mark(function t(){return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Promise.all(this.kernelConnections.map(function(){var o=O()(f()().mark(function l(y){return f()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,y.interrupt();case 2:case"end":return h.stop()}},l)}));return function(l){return o.apply(this,arguments)}}()));case 2:case"end":return s.stop()}},t,this)}));function e(){return r.apply(this,arguments)}return e}()},{key:"shutdown",value:function(){var r=O()(f()().mark(function t(){return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this.currentFileContents){s.next=4;break}return s.next=3,this.kernelManager.shutdownKernelConnections(this.currentFileContents);case 3:this.kernelConnections=[];case 4:case"end":return s.stop()}},t,this)}));function e(){return r.apply(this,arguments)}return e}()},{key:"restart",value:function(){var r=O()(f()().mark(function t(){return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(this.kernelConnections.length!==0){s.next=5;break}return s.next=3,this.startKernelConnection();case 3:s.next=7;break;case 5:return s.next=7,Promise.all(this.kernelConnections.map(function(){var o=O()(f()().mark(function l(y){return f()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,y.restart();case 2:case"end":return h.stop()}},l)}));return function(l){return o.apply(this,arguments)}}()));case 7:case"end":return s.stop()}},t,this)}));function e(){return r.apply(this,arguments)}return e}()},{key:"reconnect",value:function(){var r=O()(f()().mark(function t(){return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Promise.all(this.kernelConnections.map(function(){var o=O()(f()().mark(function l(y){return f()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,y.reconnect();case 2:case"end":return h.stop()}},l)}));return function(l){return o.apply(this,arguments)}}()));case 2:case"end":return s.stop()}},t,this)}));function e(){return r.apply(this,arguments)}return e}()},{key:"findRunningCell",value:function(){var e=this.cells.findIndex(function(t){return g.lPh.is(t.model)?t.model.kernelExecuting===!0:!1});e>-1&&(this.selectCell(this.cells[e]),this.scrollToView(this.cells[e]))}},{key:"createCheckpoint",value:function(){var r=O()(f()().mark(function t(){return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this.currentFileContents){s.next=3;break}return s.next=3,this.contentsManager.createCheckpoint(this.currentFileContents.path,{baseUrl:(0,B.Ue)()});case 3:case"end":return s.stop()}},t,this)}));function e(){return r.apply(this,arguments)}return e}()},{key:"listCheckpoints",value:function(){var r=O()(f()().mark(function t(){return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this.currentFileContents){s.next=3;break}return s.next=3,this.contentsManager.listCheckpoints(this.currentFileContents.path,{baseUrl:(0,B.Ue)()});case 3:case"end":return s.stop()}},t,this)}));function e(){return r.apply(this,arguments)}return e}()},{key:"restoreCheckpoint",value:function(){var r=O()(f()().mark(function t(i){return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!this.currentFileContents){o.next=3;break}return o.next=3,this.contentsManager.restoreCheckpoint(this.currentFileContents.path,i,{baseUrl:(0,B.Ue)()});case 3:case"end":return o.stop()}},t,this)}));function e(t){return r.apply(this,arguments)}return e}()},{key:"deleteCheckpoint",value:function(){var r=O()(f()().mark(function t(i){return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!this.currentFileContents){o.next=3;break}return o.next=3,this.contentsManager.deleteCheckpoint(this.currentFileContents.path,i,{baseUrl:(0,B.Ue)()});case 3:case"end":return o.stop()}},t,this)}));function e(t){return r.apply(this,arguments)}return e}()}]),n}(g.ero),zn=x()(je.prototype,"kernelConnecting",[_n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Dn=x()(je.prototype,"kernelConnections",[Fn,Pn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Zn=x()(je.prototype,"filePath",[Ln],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Gn=x()(je.prototype,"lspEnabled",[Kn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),je))||Y)||Y)||Y)||Y)||Y)||Y)||Y)||Y),Un,$n,ba=(Un=(0,I.H3)(),Un($n=function(c){pe()(n,c);var a=fe()(n);function n(){return Q()(this,n),a.apply(this,arguments)}return q()(n)}(g.u_T))||$n),dt=d(7317),Le=d(80155),Ca=d(42480),Ge=d(39270),Hn=d(44549),wa=Ca.Z.CheckableTag;function ka(c){var a=c.items,n=c.value,r=c.onChange,e=function(s,o){var l=o?[].concat(Be()(n),[s]):n.filter(function(y){return y!==s});r&&r(l)},t=function(s){var o=a.filter(function(l){return s.includes(l.key)});return o.length===0?"Select Nodes":o.map(function(l){return l.label}).join(",")};return(0,u.jsx)(Ge.Z.Ribbon,{text:(0,u.jsx)(xe.Z,{placement:"bottomRight",trigger:["click"],overlayStyle:{paddingTop:0},overlayClassName:"secretnote-ribbon-popover",content:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:"title",children:[M.U6.t("\u4E0B\u9762\u662F\u5C06\u8981\u6267\u884C\u8BE5\u4EE3\u7801\u7684\u8282\u70B9\u5217\u8868"),":"]}),(0,u.jsx)(Hn.Z,{size:[0,8],wrap:!0,children:a.map(function(i){return(0,u.jsx)(wa,{checked:n.includes(i.key),onChange:function(o){return e(i.key,o)},children:i.label},i.key)})})]}),children:(0,u.jsx)("span",{className:"secretnote-ribbon",children:t(n)})}),children:c.children})}var Wn,Jn,Xn,Yn,Qn,qn,er,tr,nr,rr,ar,ir,$,pt,sr,or=(0,N.forwardRef)(function(c,a){var n=(0,E.oC)(me.yd),r=n.partyList,e=n.parties;return(0,u.jsx)("div",{className:n.className,ref:a,tabIndex:10,onBlur:n.blur,children:(0,u.jsx)(ka,{items:r.map(function(t){return{label:t,key:t}}),value:e,onChange:function(i){n.onPartiesChange(i)},children:(0,u.jsx)(g.sUT,{})})})});or.displayName="SecretNoteCodeCellComponent";var ft=[],Sa=(Wn=(0,I.H3)(),Jn=(0,Ie.ei)("secretnote-code-cell-view"),Xn=function(a,n){return(0,I.f3)(me.Hj)(a,void 0,0)},Yn=function(a,n){return(0,I.f3)(g.xxA)(a,void 0,1)},Qn=function(a,n){return(0,I.f3)(dt.v)(a,void 0,2)},qn=function(a,n){return(0,I.f3)(g.fv2)(a,void 0,3)},er=function(a,n){return(0,I.f3)(U.CP)(a,void 0,4)},tr=function(a,n){return(0,I.f3)(ie)(a,void 0,5)},nr=Reflect.metadata("design:type",Function),rr=Reflect.metadata("design:paramtypes",[typeof CellViewOptions=="undefined"?Object:CellViewOptions,typeof g.xxA=="undefined"?Object:g.xxA,typeof dt.v=="undefined"?Object:dt.v,typeof g.fv2=="undefined"?Object:g.fv2,typeof U.CP=="undefined"?Object:U.CP,typeof ie=="undefined"?Object:ie]),ar=(0,E.vg)(),ir=Reflect.metadata("design:type",Array),Wn($=Jn($=Xn($=Yn($=Qn($=qn($=er($=tr($=nr($=rr($=(pt=function(c){pe()(n,c);var a=fe()(n);function n(r,e,t,i,s,o){var l;return Q()(this,n),l=a.call(this,r,e,t,i),S()(w()(l),"serverManager",void 0),S()(w()(l),"kernelManager",void 0),S()(w()(l),"view",or),G()(w()(l),"parties",sr,w()(l)),l.serverManager=s,l.kernelManager=o,l.parties=l.getInitializedParties(),l}return q()(n,[{key:"partyList",get:function(){return this.serverManager.servers.filter(function(e){return e.status===U.U$.running}).map(function(e){return e.name})}},{key:"getUsableConnections",value:function(){var e=this,t=this.parent.model;if(!t)return[];var i=(0,E.P$)(t.kernelConnections);return i.filter(function(s){if(s.isDisposed)return!1;var o=e.kernelManager.getServerByKernelConnection(s);return o&&o.status==="running"&&e.parties.includes(o.name)})}},{key:"run",value:function(){var r=O()(f()().mark(function t(){var i=this,s,o,l,y,p,h,b,m,C;return f()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(s=this.model,o=this.getUsableConnections(),o.length!==0){v.next=5;break}return _.ZP.info(M.U6.t("No available node to execute")),v.abrupt("return",!1);case 5:this.clearExecution(),this.updateExecutionStatus({executing:!0}),this.updateExecutionTime({toExecute:new Date().toISOString()}),this.savePartiesToMeta(),v.prev=9,l=[],y=f()().mark(function k(){var F,z;return f()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:F=o[p],z=F.requestExecute({code:s.value},!1),z.onIOPub=function(L){L.header.msg_type==="execute_input"&&(i.updateExecutionStatus({kernelExecuting:!0}),i.updateExecutionTime({start:L.header.date})),s.msgChangeEmitter.fire({connection:F,msg:L})},z.onReply=function(L){s.msgChangeEmitter.fire({connection:F,msg:L})},l.push(z.done);case 5:case"end":return P.stop()}},k)}),p=0,h=o.length;case 13:if(!(p<h)){v.next=18;break}return v.delegateYield(y(),"t0",15);case 15:p+=1,v.next=13;break;case 18:return v.next=20,Promise.all(l);case 20:if(b=v.sent,this.updateExecutionStatus({executing:!1,kernelExecuting:!1}),this.updateExecutionTime(this.parseMessageTime(b)),m=b.every(function(k){return k.content.status==="ok"}),!m){v.next=28;break}return v.abrupt("return",!0);case 28:if(C=b.find(function(k){return k.content.status!=="ok"}),!C){v.next=31;break}throw new g.e__(C.content);case 31:return v.abrupt("return",!1);case 32:v.next=39;break;case 34:if(v.prev=34,v.t1=v.catch(9),!(v.t1 instanceof Error&&v.t1.message.startsWith("Canceled"))){v.next=38;break}return v.abrupt("return",!1);case 38:throw v.t1;case 39:case"end":return v.stop()}},t,this,[[9,34]])}));function e(){return r.apply(this,arguments)}return e}()},{key:"updateExecutionStatus",value:function(e){var t=e.executing,i=e.kernelExecuting;(0,Le.Z)(t)||(this.model.executing=t),(0,Le.Z)(i)||(this.model.kernelExecuting=i)}},{key:"updateExecutionTime",value:function(e){var t=this.model.metadata.execution;if(t){var i=e.start,s=e.end,o=e.toExecute;(0,Le.Z)(i)||(t["shell.execute_reply.started"]=i),(0,Le.Z)(s)||(t["shell.execute_reply.end"]=s),(0,Le.Z)(o)||(t.to_execute=o)}}},{key:"parseMessageTime",value:function(e){var t="",i="";return e.forEach(function(s){var o=s.metadata.started,l=s.header.date;(t===""||(0,B.Id)(o,t)<0)&&(t=o),(i===""||(0,B.Id)(l,i)>0)&&(i=l)}),{start:t,end:i}}},{key:"onPartiesChange",value:function(e){this.parties=e,this.savePartiesToMeta(e),ft=e}},{key:"getInitializedParties",value:function(){var e=this,t=this.model.metadata.execution;if(t&&t.parties)try{var i=JSON.parse(t.parties);return i.filter(function(s){return e.partyList.includes(s)})}catch(s){return[]}else if(ft.length>0)return ft;return this.partyList}},{key:"savePartiesToMeta",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.parties,t=this.model.metadata.execution;t&&(t.parties=JSON.stringify(e))}}]),n}(g.qmq),sr=x()(pt.prototype,"parties",[ar,ir],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),pt))||$)||$)||$)||$)||$)||$)||$)||$)||$)||$),Ta=d(74799),lr,ur,Oa=(lr=(0,I.ri)({contrib:g.Vij}),lr(ur=function(){function c(){Q()(this,c),S()(this,"canHandle",function(){return 3})}return q()(c,[{key:"loadContent",value:function(){var a=O()(f()().mark(function r(e,t){var i,s,o,l;return f()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return i=t,s=new Ta.o(e.resource),o=s.path.toString(),p.next=5,i.contentsManager.get(o,{baseUrl:(0,B.Ue)(),content:!0});case 5:if(l=p.sent,!l){p.next=12;break}return l.content.nbformat_minor=5,i.currentFileContents=l,i.filePath=l.path,!i.quickEditMode&&!i.readOnly&&i.startKernelConnection(),p.abrupt("return",i.currentFileContents.content);case 12:case"end":return p.stop()}},r)}));function n(r,e){return a.apply(this,arguments)}return n}()}]),c}())||ur),Ba=d(78846),Ia=d.n(Ba),Aa=d(54088),Na=d.n(Aa),cr,dr,pr,fr,mr,vr,oe,Ma=(cr=(0,I.H3)(),dr=(0,Ie.ei)("libro-output-area"),pr=function(a,n){return(0,I.f3)(me.Hj)(a,void 0,0)},fr=function(a,n){return(0,I.f3)(ie)(a,void 0,1)},mr=Reflect.metadata("design:type",Function),vr=Reflect.metadata("design:paramtypes",[typeof IOutputAreaOption=="undefined"?Object:IOutputAreaOption,typeof ie=="undefined"?Object:ie]),cr(oe=dr(oe=pr(oe=fr(oe=mr(oe=vr(oe=function(c){pe()(n,c);var a=fe()(n);function n(r,e){var t;return Q()(this,n),t=a.call(this,r),S()(w()(t),"kernelManager",void 0),S()(w()(t),"connectionId2Message",{}),t.kernelManager=e,t.connectionId2Message={},t.handleMsg(),t}return q()(n,[{key:"handleMsg",value:function(){var e=this,t=this.cell.model;t.msgChangeEmitter.event(function(i){var s=i.connection,o=i.msg;if(o.header.msg_type!=="status"){if(o.header.msg_type==="execute_input"&&(t.executeCount=o.content.execution_count),(0,g.t3d)(o)||(0,g.HXF)(o)||(0,g.aL4)(o)||(0,g.fkE)(o)){var l=j()(j()({},o.content),{},{output_type:o.header.msg_type});e.addOutput(s,l)}if((0,g.vUL)(o)){var y=o.content;if(y.status!=="ok")return;var p=y&&y.payload;if(!p||!p.length)return;var h=p.filter(function(C){return C.source==="page"});if(!h.length)return;var b=JSON.parse(JSON.stringify(h[0])),m={output_type:"display_data",data:b.data,metadata:{}};e.addOutput(s,m)}}})}},{key:"addOutput",value:function(e,t){var i=this.connectionId2Message[e.id]||[];i.length===0&&i.push(this.getBreakOutput(e));var s=i.length-1,o=i[s];if((0,g.eeP)(t)&&(0,g.eeP)(o)&&t.name===o.name){t.text=(0,g.e$h)(o.text+(0,g.Fvn)(t.text)),i[s]=t,this.flushOutputs();return}(0,g.eeP)(t)&&(t.text=(0,g.e$h)((0,g.Fvn)(t.text))),i.push(t),this.connectionId2Message[e.id]=i,this.flushOutputs()}},{key:"flushOutputs",value:function(){var r=O()(f()().mark(function t(){var i=this,s,o;return f()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return s=Object.keys(this.connectionId2Message).length,o=Object.values(this.connectionId2Message).flat(),s<2&&(o=o.filter(function(p){return!p.breakFlag})),this.outputs.forEach(function(p){p.dispose()}),y.next=6,Promise.all(o.map(function(p){return i.doCreateOutput(p)}));case 6:this.outputs=y.sent;case 7:case"end":return y.stop()}},t,this)}));function e(){return r.apply(this,arguments)}return e}()},{key:"getBreakOutput",value:function(e){var t=this.kernelManager.getServerByKernelConnection(e),i=(t==null?void 0:t.name)||e.clientId,s={output_type:"display_data",data:{"text/html":"<h4>".concat(i,"'s Output:</h4>")},metadata:{},breakFlag:!0};return s}},{key:"clear",value:function(){Ia()(Na()(n.prototype),"clear",this).call(this),this.connectionId2Message={}}}]),n}(g.fZS))||oe)||oe)||oe)||oe)||oe)||oe),xa=Oe.R.create().register(Oa,Ma,{token:g.ero,useClass:ya},{token:g.DHb,useClass:ba},{token:g.iKk,useClass:Sa}).dependOn(g.MDs,U.aB,ga),Ea=d(52080),hr=d(20904),ja=d(31300),Va=d(22825),Ue=d(40256),gr,yr,br,Cr,wr,kr,Sr,Tr,Or,le,$e,Br,Ir,Ar=(gr=(0,I.ri)(),yr=function(a,n){return(0,I.f3)(U.CP)(a,void 0,0)},br=function(a,n){return(0,I.f3)(ie)(a,void 0,1)},Cr=function(a,n){return(0,I.f3)(Ue.nR)(a,void 0,2)},wr=Reflect.metadata("design:type",Function),kr=Reflect.metadata("design:paramtypes",[typeof U.CP=="undefined"?Object:U.CP,typeof ie=="undefined"?Object:ie,typeof Ue.nR=="undefined"?Object:Ue.nR]),Sr=(0,E.vg)(),Tr=Reflect.metadata("design:type",Array),Or=(0,E.vg)(),gr(le=yr(le=br(le=Cr(le=wr(le=kr(le=($e=function(){function c(a,n,r){var e=this;Q()(this,c),S()(this,"_pollModels",void 0),S()(this,"serverManager",void 0),S()(this,"kernelManager",void 0),S()(this,"notebookFileService",void 0),G()(this,"metrics",Br,this),G()(this,"enabled",Ir,this),this.serverManager=a,this.kernelManager=n,this.notebookFileService=r,this.notebookFileService.onNotebookFileChanged(function(){e.refresh()}),this._pollModels=new Va.n_({auto:!1,factory:function(){return e.getMetrics()},frequency:{interval:4*1e3,backoff:!0,max:300*1e3},name:"metrics",standby:"when-hidden"})}return q()(c,[{key:"enable",value:function(){var a=O()(f()().mark(function r(){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.enabled=!0,this.getDefaultMetrics(),t.next=4,(0,E.P$)(this._pollModels).start();case 4:return t.next=6,(0,E.P$)(this._pollModels).tick;case 6:case"end":return t.stop()}},r,this)}));function n(){return a.apply(this,arguments)}return n}()},{key:"disable",value:function(){var a=O()(f()().mark(function r(){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.enabled=!1,t.next=3,(0,E.P$)(this._pollModels).stop();case 3:case"end":return t.stop()}},r,this)}));function n(){return a.apply(this,arguments)}return n}()},{key:"refresh",value:function(){var a=O()(f()().mark(function r(){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.enabled){t.next=5;break}return t.next=3,(0,E.P$)(this._pollModels).refresh();case 3:return t.next=5,(0,E.P$)(this._pollModels).tick;case 5:case"end":return t.stop()}},r,this)}));function n(){return a.apply(this,arguments)}return n}()},{key:"getDefaultMetrics",value:function(){var n=this.notebookFileService.currentNotebookFile,r=[];if(n)for(var e=this.kernelManager.getKernelConnections(n),t=0,i=e.length;t<i;t++){var s=e[t],o=s.model,l=s.status,y=o.id,p=o.name,h=g.jro[l],b=h.color,m=h.text_zh,C=this.kernelManager.getServerByKernelConnection(s);C&&r.push({server:C,host:{cpu:0,memory:0,cpuText:"N/A",memoryText:"N/A"},kernel:{id:y,name:p,pid:"",status:l,statusText:m,statusColor:b,cpu:0,memory:0,options:[],cpuText:"N/A",memoryText:"N/A"}})}return this.metrics=r,r}},{key:"getMetrics",value:function(){var a=O()(f()().mark(function r(){var e,t,i,s,o,l;return f()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(e=this.notebookFileService.currentNotebookFile,t=[],!e){p.next=13;break}i=this.kernelManager.getKernelConnections(e),s=0,o=i.length;case 5:if(!(s<o)){p.next=13;break}return p.next=8,this.getMetricsItem(i[s]);case 8:l=p.sent,l&&t.push(l);case 10:s++,p.next=5;break;case 13:return this.metrics=t,p.abrupt("return",t);case 15:case"end":return p.stop()}},r,this)}));function n(){return a.apply(this,arguments)}return n}()},{key:"getMetricsItem",value:function(){var a=O()(f()().mark(function r(e){var t,i,s;return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(t=this.kernelManager.getServerByKernelConnection(e),t){l.next=3;break}return l.abrupt("return");case 3:return l.next=5,this.getServerStatus(t);case 5:return i=l.sent,l.next=8,this.getKernelStatus(t,e);case 8:return s=l.sent,l.abrupt("return",{server:t,host:i,kernel:s});case 10:case"end":return l.stop()}},r,this)}));function n(r){return a.apply(this,arguments)}return n}()},{key:"getServerStatus",value:function(){var a=O()(f()().mark(function r(e){var t,i,s;return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,t="/api/metrics/v1",i={method:"GET"},l.next=5,(0,B.WY)(t,i,e.id);case 5:return s=l.sent,l.abrupt("return",{cpu:s.cpu_percent,memory:s.rss,cpuText:"".concat(s.cpu_percent," %"),memoryText:this.humanFileSize(s.rss)});case 9:l.prev=9,l.t0=l.catch(0),console.log(l.t0);case 12:return l.abrupt("return",{cpu:0,memory:0,cpuText:"N/A",memoryText:"N/A"});case 13:case"end":return l.stop()}},r,this,[[0,9]])}));function n(r){return a.apply(this,arguments)}return n}()},{key:"getKernelStatus",value:function(){var a=O()(f()().mark(function r(e,t){var i,s,o,l,y,p,h,b,m,C,A,v,k,F,z,H,P;return f()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return i=t.model,s=t.status,o=i.id,l=i.name,y=e.kernelspec?Object.keys(e.kernelspec.kernelspecs):[],W.prev=3,p="/api/metrics/v1/kernel_usage/get_usage/"+o,h={method:"GET"},W.next=8,(0,B.WY)(p,h,e.id);case 8:return b=W.sent,m=this.parseKernelStatus(b),C=m.cpu,A=m.memory,v=m.pid,k=m.cpuText,F=m.memoryText,z=g.jro[s],H=z.color,P=z.text_zh,W.abrupt("return",{id:o,name:l,pid:v,status:s,statusText:P,statusColor:H,cpu:C,memory:A,options:y,cpuText:k,memoryText:F});case 14:W.prev=14,W.t0=W.catch(3),console.log(W.t0);case 17:return W.abrupt("return",{id:o,name:l,pid:"",status:"unknown",statusText:g.jro.unknown.text_zh,statusColor:g.jro.unknown.color,cpu:0,memory:0,options:y,cpuText:"N/A",memoryText:"N/A"});case 18:case"end":return W.stop()}},r,this,[[3,14]])}));function n(r,e){return a.apply(this,arguments)}return n}()},{key:"humanFileSize",value:function(n){var r=Math.floor(Math.log(n)/Math.log(1024));return(n/Math.pow(1024,r)).toFixed(2)+" "+["B","kB","MB","GB","TB"][r]}},{key:"parseKernelStatus",value:function(n){var r=n.content.kernel_cpu,e=n.content.kernel_memory,t=n.content.pid,i="".concat(r," %"),s=this.humanFileSize(e);return{cpu:r,memory:e,pid:t,cpuText:i,memoryText:s}}}]),c}(),Br=x()($e.prototype,"metrics",[Sr,Tr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ir=x()($e.prototype,"enabled",[Or],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),$e))||le)||le)||le)||le)||le)||le),Ra=d(62402),_a=d(19689),Fa=d(63709),Pa=d(33428),Nr=d(15304),Mr=function(a){var n=a.data,r=(0,N.useRef)(null),e=(0,N.useRef)();return(0,N.useEffect)(function(){if(r.current){var t=new Nr.SmoothieChart({millisPerPixel:50,grid:{fillStyle:"#ffffff",strokeStyle:"rgba(119,119,119,0.22)",lineWidth:1},labels:{disabled:!0},tooltip:!1}),i=new Nr.TimeSeries;t.addTimeSeries(i,{lineWidth:1,strokeStyle:"rgba(24,144,255,1)",fillStyle:"rgba(24,144,255,0.2)",interpolation:"bezier"}),t.streamTo(r.current,2e3),e.current=i}},[]),(0,N.useEffect)(function(){e.current&&e.current.append(n.time,n.data)},[n]),(0,u.jsx)("canvas",{ref:r,width:"270",height:"60"})},La=function(a){var n=a.visible,r=a.close,e=(0,E.oC)(Ar),t=e.metrics,i=function(){var o=O()(f()().mark(function l(y){return f()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:y&&e.enable();case 1:case"end":return h.stop()}},l)}));return function(y){return o.apply(this,arguments)}}(),s=function(){e.disable(),r()};return(0,u.jsx)(Pa.Z,{placement:"right",onClose:function(){return s()},width:360,open:n,mask:!1,afterOpenChange:i,destroyOnClose:!0,title:M.U6.t("\u8D44\u6E90\u6D88\u8017"),children:(0,u.jsx)("div",{className:"secretnote-kernel-status",children:t.map(function(o){return(0,u.jsxs)("div",{className:"kernel-status-item",children:[(0,u.jsxs)("div",{className:"server-name",children:[o.server.name,":"]}),(0,u.jsxs)("div",{className:"metrics-item",children:[(0,u.jsxs)("span",{className:"label",children:[M.U6.t("\u540D\u79F0"),":"]}),(0,u.jsx)("span",{children:o.kernel.name})]}),(0,u.jsxs)("div",{className:"metrics-item",children:[(0,u.jsxs)("span",{className:"label",children:[M.U6.t("\u72B6\u6001"),":"]}),(0,u.jsx)(Ge.Z,{color:o.kernel.statusColor,text:o.kernel.statusText})]}),(0,u.jsxs)("div",{className:"metrics-item",children:[(0,u.jsx)("span",{className:"label",children:"PID:"}),(0,u.jsx)("span",{children:o.kernel.pid})]}),(0,u.jsxs)("div",{className:"metrics-item",children:[(0,u.jsx)("span",{className:"label",children:"CPU:"}),(0,u.jsx)("span",{children:o.kernel.cpuText})]}),(0,u.jsx)(Mr,{data:{time:Date.now(),data:o.kernel.cpu}}),(0,u.jsxs)("div",{className:"metrics-item",children:[(0,u.jsx)("span",{className:"label",children:"RAM:"}),(0,u.jsx)("span",{children:o.kernel.memoryText})]}),(0,u.jsx)(Mr,{data:{time:Date.now(),data:o.kernel.memory}})]},o.kernel.id)})})})},xr={id:"secretnote-metrics-panel-modal",component:La},Er,jr,Vr,Rr,Se,mt={id:"metrics-panel-open"},Ka=function(){var a=(0,E.oC)(Ze.Z),n=function(){a.openModal(xr)};return(0,u.jsx)(Fa.Z,{className:"chat-icon",onClick:n,size:16})},za=(Er=(0,I.ri)({contrib:[ve.p,Ra.H,_a.l]}),jr=function(a,n){return(0,I.f3)(g.w29)(a,void 0,0)},Vr=Reflect.metadata("design:type",Function),Rr=Reflect.metadata("design:paramtypes",[typeof g.w29=="undefined"?Object:g.w29]),Er(Se=jr(Se=Vr(Se=Rr(Se=function(){function c(a){Q()(this,c),S()(this,"libroCommand",void 0),this.libroCommand=a}return q()(c,[{key:"registerCommands",value:function(n){this.libroCommand.registerLibroCommand(n,mt,{execute:function(){var r=O()(f()().mark(function t(i,s){return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(!s||!(s instanceof g.yZV))){l.next=2;break}return l.abrupt("return");case 2:case"end":return l.stop()}},t)}));function e(t,i){return r.apply(this,arguments)}return e}(),isVisible:function(e,t,i){return i===g.xNW.HeaderRight},isEnabled:function(e,t){return!t||!(t instanceof g.yZV)?!1:!!t.model.kernelConnection}})}},{key:"registerToolbarItems",value:function(n){n.registerItem({id:mt.id,icon:Ka,command:mt.id,order:"a",tooltip:M.U6.t("\u67E5\u770B\u72B6\u6001")})}},{key:"registerModal",value:function(){return xr}}]),c}())||Se)||Se)||Se)||Se),Da=Oe.R.create().register(za,Ar),_r,Fr,Pr,Lr,Te,Za=(0,B.Q4)(),He=(_r=(0,I.ri)(),Fr=function(a,n){return(0,I.f3)(U.CP)(a,void 0,0)},Pr=Reflect.metadata("design:type",Function),Lr=Reflect.metadata("design:paramtypes",[typeof U.CP=="undefined"?Object:U.CP]),_r(Te=Fr(Te=Pr(Te=Lr(Te=function(){function c(a){Q()(this,c),S()(this,"serverManager",void 0),this.serverManager=a}return q()(c,[{key:"nodes",get:function(){return this.serverManager.servers.map(function(n){return j()(j()({},n),{},{color:Za})})}},{key:"addNode",value:function(){var a=O()(f()().mark(function r(e){var t,i,s;return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return t=e.name,i=e.address,s=e.type,l.next=3,this.serverManager.addServer({name:t.trim(),address:i.trim(),type:s});case 3:return l.abrupt("return",l.sent);case 4:case"end":return l.stop()}},r,this)}));function n(r){return a.apply(this,arguments)}return n}()},{key:"deleteNode",value:function(){var a=O()(f()().mark(function r(e){return f()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.serverManager.deleteServer(e);case 2:case"end":return i.stop()}},r,this)}));function n(r){return a.apply(this,arguments)}return n}()},{key:"updateNodeName",value:function(){var a=O()(f()().mark(function r(e,t){return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.serverManager.updateServer(e,{name:t});case 2:case"end":return s.stop()}},r,this)}));function n(r,e){return a.apply(this,arguments)}return n}()},{key:"checkName",value:function(n){var r=this.nodes.every(function(e){return e.name!==n});return r}},{key:"checkAddress",value:function(n){var r=this,e=this.nodes.every(function(t){return r.normalizedAddress(t.address)!==r.normalizedAddress(n)});return e}},{key:"normalizedAddress",value:function(n){return n.replace("localhost","127.0.0.1")}}]),c}())||Te)||Te)||Te)||Te),Ga=d(99138),Ua=d(37806),vt=d(35198),Kr=d(32368),$a=d(99997),zr,Dr,Zr,Gr,Ur,de,Ha=Ua.Z.Paragraph,$r=function(a){var n=a.status;return n===U.U$.running?{status:"success",badgeStatus:"success",text:M.U6.t("\u5728\u7EBF")}:n===U.U$.error?{status:"error",badgeStatus:"error",text:M.U6.t("\u79BB\u7EBF")}:{status:"default",badgeStatus:"default",text:M.U6.t("\u79BB\u7EBF")}},Wa=function(a){var n=a.node,r=(0,E.oC)(me.yd),e=$r(n),t=e.status,i=e.text,s=(0,N.useState)(n.name),o=ae()(s,2),l=o[0],y=o[1],p=function(){var b=O()(f()().mark(function m(C){return f()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.prev=0,v.next=3,r.service.deleteNode(C);case 3:_.ZP.success(M.U6.t("\u5220\u9664\u6210\u529F")),v.next=9;break;case 6:v.prev=6,v.t0=v.catch(0),v.t0 instanceof Error&&_.ZP.error(v.t0.message);case 9:case"end":return v.stop()}},m,null,[[0,6]])}));return function(C){return b.apply(this,arguments)}}(),h=function(){var b=O()(f()().mark(function m(C,A){return f()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(C.name!==A){k.next=2;break}return k.abrupt("return");case 2:return k.prev=2,k.next=5,r.service.updateNodeName(C.id,A);case 5:y(A),k.next=11;break;case 8:k.prev=8,k.t0=k.catch(2),k.t0 instanceof Error&&_.ZP.error(k.t0.message);case 11:case"end":return k.stop()}},m,null,[[2,8]])}));return function(C,A){return b.apply(this,arguments)}}();return(0,u.jsxs)("div",{className:"secretnote-node-description",children:[(0,u.jsxs)(T.Z,{title:M.U6.t("\u8282\u70B9\u4FE1\u606F"),column:1,children:[(0,u.jsx)(T.Z.Item,{label:M.U6.t("\u540D\u79F0"),children:(0,u.jsx)(Ha,{editable:{onChange:function(m){return h(n,m)},tooltip:!1},children:l})}),(0,u.jsx)(T.Z.Item,{label:M.U6.t("\u5730\u5740"),children:n.address}),(0,u.jsx)(T.Z.Item,{label:M.U6.t("\u72B6\u6001"),children:(0,u.jsx)(Ge.Z,{status:t,text:i})})]}),(0,u.jsx)(vt.ZP,{type:"link",onClick:function(){p(n.id)},children:M.U6.t("\u5220\u9664")})]})},Ja=function(){var a=K.Z.useForm(),n=ae()(a,1),r=n[0],e=(0,N.useState)(!1),t=ae()(e,2),i=t[0],s=t[1],o=(0,N.useState)(!1),l=ae()(o,2),y=l[0],p=l[1],h=(0,E.oC)(me.yd),b=function(){r.validateFields().then(function(){var A=O()(f()().mark(function v(k){var F;return f()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return p(!0),H.next=3,h.service.addNode(k);case 3:return F=H.sent,F.status===U.U$.running?_.ZP.success(M.U6.t("\u8282\u70B9\u6DFB\u52A0\u6210\u529F")):_.ZP.info("\u8282\u70B9\u6DFB\u52A0\u6210\u529F\uFF0C\u4F46\u662F\u8282\u70B9\u5904\u4E8E\u79BB\u7EBF\u72B6\u6001"),s(!1),r.resetFields(),p(!1),H.abrupt("return");case 9:case"end":return H.stop()}},v)}));return function(v){return A.apply(this,arguments)}}()).catch(function(){})},m=(0,u.jsx)("div",{className:"secretnote-add-node",children:(0,u.jsxs)(K.Z,{form:r,autoComplete:"off",requiredMark:!1,labelCol:{span:4},wrapperCol:{span:20},initialValues:{name:"",address:"",type:"common"},children:[(0,u.jsx)(K.Z.Item,{label:M.U6.t("\u540D\u79F0"),name:"name",rules:[{required:!0,message:M.U6.t("\u8BF7\u8F93\u5165\u540D\u79F0")},{max:16,message:M.U6.t("\u540D\u79F0\u8FC7\u957F")}],children:(0,u.jsx)(te.Z,{placeholder:"Alice"})}),(0,u.jsx)(K.Z.Item,{label:M.U6.t("\u5730\u5740"),name:"address",rules:[{required:!0,message:M.U6.t("\u8BF7\u8F93\u5165\u5730\u5740")},{max:100,message:M.U6.t("\u5730\u5740\u8FC7\u957F")}],children:(0,u.jsx)(te.Z,{placeholder:"127.0.0.1:8888"})}),(0,u.jsx)(K.Z.Item,{wrapperCol:{offset:4,span:20},style:{marginBottom:0},children:(0,u.jsx)(Hn.Z,{children:(0,u.jsx)(vt.ZP,{type:"primary",htmlType:"submit",onClick:function(){b()},loading:y,children:M.U6.t("\u6DFB\u52A0")})})})]})});return(0,u.jsxs)("div",{className:"secretnote-node",children:[(0,u.jsx)(Kr.C.Group,{children:h.service.nodes.map(function(C){return(0,u.jsx)(xe.Z,{content:(0,u.jsx)(Wa,{node:C}),title:"",overlayClassName:"secretnote-node-popover",overlayStyle:{width:280},trigger:"click",placement:"bottomLeft",arrow:!1,children:(0,u.jsx)(Ge.Z,{status:$r(C).badgeStatus,dot:!0,offset:[-28,4],children:(0,u.jsx)(Kr.C,{shape:"square",style:{backgroundColor:C.color,cursor:"pointer"},children:(0,u.jsx)("span",{style:{color:(0,B.U_)(C.color)},children:C.name.slice(0,1).toUpperCase()})})})},C.id)})}),(0,u.jsx)(xe.Z,{content:m,title:"",overlayClassName:"secretnote-node-popover",overlayStyle:{width:446},trigger:"click",placement:"bottomLeft",open:i,onOpenChange:function(A){r.resetFields(),s(A)},arrow:!1,children:(0,u.jsx)(vt.ZP,{icon:(0,u.jsx)($a.Z,{size:16}),className:"btn",onClick:function(){return s(!0)}})})]})},Hr=(zr=(0,I.ri)(),Dr=(0,Ie.ei)("secretnote-node-view"),Zr=function(a,n){return(0,I.f3)(He)(a,void 0,0)},Gr=Reflect.metadata("design:type",Function),Ur=Reflect.metadata("design:paramtypes",[typeof He=="undefined"?Object:He]),zr(de=Dr(de=Zr(de=Gr(de=Ur(de=function(c){pe()(n,c);var a=fe()(n);function n(r){var e;return Q()(this,n),e=a.call(this),S()(w()(e),"view",Ja),S()(w()(e),"service",void 0),e.service=r,e}return q()(n)}(Ga.P))||de)||de)||de)||de)||de),Xa=Oe.R.create().register(Hr,He,(0,Ie.bQ)({slot:hr.Mx.right,view:Hr,autoCreate:!0})),Ya=d(20252),Qa=d(97341),qa=d(352),ei=d(34408),ti=function(){return(0,u.jsx)(Ke.rF.Application,{asChild:!0,modules:[We.n6L,hr.xu,Qa.O,Ya.F,xa,Ue.qi,Xa,qa.V,Ea.Q,Da,ja.p,ei.u,va]},"libro-app")},ni=ti}}]);
