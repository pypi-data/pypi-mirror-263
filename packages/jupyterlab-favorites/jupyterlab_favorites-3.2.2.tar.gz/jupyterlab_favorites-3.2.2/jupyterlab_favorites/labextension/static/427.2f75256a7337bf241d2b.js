"use strict";(self.webpackChunk_jlab_enhanced_favorites=self.webpackChunk_jlab_enhanced_favorites||[]).push([[427],{427:(e,t,a)=>{a.r(t),a.d(t,{IFavorites:()=>j,default:()=>I});var i=a(311),s=a(31),o=a(557),r=a(8),n=a(452),l=a(882),v=a(29),c=a.n(v),d=a(901);const h=new n.LabIcon({name:"jupyterlab-favorites:filledStar",svgstr:'<svg\n  xmlns="http://www.w3.org/2000/svg"\n  viewBox="0 0 24 24"\n>\n  <path\n    d="M0 0h24v24H0z"\n    fill="none"\n  />\n  \x3c!-- The "fill" property has been modified from the original --\x3e\n  <path class="jp-icon3"  fill="rgb(97,97,97)"\n    d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"\n  />\n  <path\n    d="M0 0h24v24H0z"\n    fill="none"\n  />\n</svg>'}),m=new n.LabIcon({name:"jupyterlab-favorites:star",svgstr:'<svg\n  xmlns="http://www.w3.org/2000/svg"\n  viewBox="0 0 24 24"\n>\n  \x3c!-- The "fill" property has been modified from the original --\x3e\n  <path class="jp-icon3"  fill="rgb(97,97,97)"\n    d="M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"\n  />\n  <path\n    d="M0 0h24v24H0z"\n    fill="none"\n  />\n</svg>'});function f(e){return e?h:m}function g(e){return[i.PathExt.basename(e),i.PathExt.dirname(e)]}function u(e){return(e?"Remove":"Add")+" Favorite"}function p(e,t){return i.PathExt.join(e,t)}const F=e=>{const{favorite:t,handleClick:a}=e;let i,[s,o]=g(t.path);return t.name?(s=t.name,o=""):o="/"+o,i=t.iconLabel?n.LabIcon.resolve({icon:t.iconLabel}):"directory"===t.contentType?n.folderIcon:n.fileIcon,v.createElement("div",{className:"jp-Favorites-item",title:p(t.root,t.path),onClick:e=>{a(t)},"data-path":t.path},v.createElement(i.react,{className:"jp-Favorites-itemIcon",tag:"span"}),v.createElement("span",{className:"jp-Favorites-itemText"},s,v.createElement("span",{className:"jp-Favorites-dirname"},o)))},b=e=>{const t=e.currentPath;return t?v.createElement(n.UseSignal,{signal:e.manager.favoritesChanged,initialSender:e.manager},(a=>{var i;const s=null!==(i=null==a?void 0:a.hasFavorite(t))&&void 0!==i&&i,o=f(s);return v.createElement("button",{className:"jp-ToolbarButtonComponent jp-Button jp-mod-minimal",title:u(s),onClick:a=>{e.handleClick(t)}},v.createElement(o.react,{className:"jp-Favorites-BreadCrumbs-Icon",tag:"span"}))})):null};class y extends n.ReactWidget{constructor(e,t){super(),this.pathChanged=new d.Signal(this),this.manager=e,this.filebrowser=t,this.addClass("jp-Favorites"),this.filebrowser.model.pathChanged.connect(((e,t)=>{const a=t.newValue;this.pathChanged.emit(a)}))}render(){return v.createElement(n.UseSignal,{signal:this.manager.favoritesChanged,initialSender:this.manager,initialArgs:this.manager.visibleFavorites()},((e,t)=>v.createElement("div",null,v.createElement(n.UseSignal,{signal:e.visibilityChanged,initialSender:e,initialArgs:e.isVisible()},((e,a)=>a&&v.createElement(v.Fragment,null,v.createElement("div",{className:"jp-Favorites-header"},"Favorites"),v.createElement("div",{className:"jp-Favorites-container"},(null!=t?t:[]).map((t=>v.createElement(F,{key:`favorites-item-${t.path}`,favorite:t,handleClick:e.handleClick.bind(e)})))),v.createElement("div",{className:"jp-FileBrowser-header"},"File Browser")))))))}}var w,C,R,_=a(930);!function(e){e.favorites="jupyterlab-favorites"}(w||(w={})),function(e){e.addOrRemoveFavorite=`${w.favorites}:add-or-remove-favorite`,e.removeFavorite=`${w.favorites}:remove-favorite`,e.renameFavorite=`${w.favorites}:rename-favorite`,e.openFavorite=`${w.favorites}:open-favorite`,e.toggleFavoritesWidget=`${w.favorites}:toggle-favorites-widget`,e.restoreDefaults=`${w.favorites}:restore-defaults`,e.clearFavorites=`${w.favorites}:clear-favorites`}(C||(C={})),function(e){e.themes="@jupyterlab/apputils-extension:themes",e.favorites="@jlab-enhanced/favorites:favorites"}(R||(R={}));const j=new _.Token("jupyterlab-favorites:IFavorites");class x{constructor(e,t,a,i){this.favoritesChanged=new d.Signal(this),this.visibilityChanged=new d.Signal(this),this._favorites=[],this._showWidget=!1,this._showWidget=!0,this._serverRoot=e,this._commandRegistry=t,this._settingsRegistry=a,this._contentsManager=i,this.favoritesMenu=new l.Menu({commands:this._commandRegistry}),this.favoritesMenu.title.label="Favorites",this._settingsRegistry.pluginChanged.connect((async(e,t)=>{t===R.favorites&&this.loadFavorites()})),this.favoritesChanged.connect((async e=>{this._showWidget=await this.loadShowWidget(),this.syncFavoritesMenu(),this.visibilityChanged.emit(this.isVisible())}))}get serverRoot(){return this._serverRoot}get favorites(){return this._favorites.filter((e=>e.root===this.serverRoot))}set favorites(e){this._favorites=e,this.favoritesChanged.emit(this.visibleFavorites())}async addFavorite(e){const t=this._favorites.slice(),a=t.findIndex((t=>t.root===this.serverRoot&&t.path===e.path)),i=t[a];i?i.hidden&&(i.hidden=!1,this.saveSettings({favorites:t})):this.saveSettings({favorites:t.concat([e])})}clearFavorites(){this.clearFavoritesOrRestoreDefaults(!0)}init(){this.loadFavorites()}isVisible(){return this._showWidget&&this.visibleFavorites(!1).length>0}hasFavorite(e){return this.visibleFavorites(!1).findIndex((t=>t.path===e))>=0}handleClick(e){this._commandRegistry.execute(C.openFavorite,{favorite:e})}async overwriteSettings(e){const t=JSON.stringify(e,null,4);this._settingsRegistry.upload(R.favorites,t)}async renameFavorite(e,t){const a=this._favorites.slice(),i=a.find((t=>t.root===this.serverRoot&&t.path===e));i&&(i.name=t,this.saveSettings({favorites:a}))}async removeFavorite(e){const t=this._favorites.slice(),a=t.findIndex((t=>t.root===this.serverRoot&&t.path===e)),i=t[a];i&&(i.default?i.hidden=!0:t.splice(a,1),this.saveSettings({favorites:t}))}async removeFavoriteIfInvalid(e){this._contentsManager.get(e.path,{content:!1}).catch((t=>{404===t.response.status&&this.removeFavorite(e.path)}))}restoreDefaults(){this.clearFavoritesOrRestoreDefaults(!1)}async saveSettings(e){void 0!==e.favorites&&await this._settingsRegistry.set(R.favorites,"favorites",e.favorites),void 0!==e.showWidget&&this._settingsRegistry.set(R.favorites,"showWidget",e.showWidget)}visibleFavorites(e=!0){const t=this.favorites.filter((e=>!e.hidden));return e?t.sort(((e,t)=>e.contentType===t.contentType?g(e.path)<=g(t.path)?-1:1:e.contentType<t.contentType?-1:1)):t}clearFavoritesOrRestoreDefaults(e){const t=this._favorites,a=[];t.forEach((t=>{t.default&&(t.hidden=e,a.push(t))})),this.overwriteSettings({favorites:a})}async loadFavorites(){var e;const t=null!==(e=(await this._settingsRegistry.get(R.favorites,"favorites")).composite)&&void 0!==e?e:[];this.favorites=t.map((e=>{var t;return{...e,root:null!==(t=e.root)&&void 0!==t?t:this.serverRoot}}))}async loadShowWidget(){var e;return null!==(e=(await this._settingsRegistry.get(R.favorites,"showWidget")).composite)&&void 0!==e&&e}syncFavoritesMenu(){this.favoritesMenu.clearItems();const e=this.visibleFavorites();e.length>0&&(e.forEach((e=>{this.favoritesMenu.addItem({command:C.openFavorite,args:{favorite:e}})})),this.favoritesMenu.addItem({type:"separator"}));const t=this._showWidget;this.favoritesMenu.addItem({command:C.toggleFavoritesWidget,args:{showWidget:t}}),this.favoritesMenu.addItem({command:C.restoreDefaults}),this.favoritesMenu.addItem({command:C.clearFavorites})}}var M=a(510);const I={id:w.favorites,autoStart:!0,requires:[s.IFileBrowserFactory,r.ISettingRegistry],provides:j,optional:[s.IDefaultFileBrowser,o.IMainMenu],activate:(e,t,a,s,o)=>{console.log("JupyterLab extension jupyterlab-favorites is activated!");const r=e.docRegistry,{commands:v,serviceManager:d}=e,h=new x(i.PageConfig.getOption("serverRoot")||"Jupyter Server Root",v,a,d.contents);if(h.init(),s){const e=new y(h,s);s.layout.insertWidget(0,e);const t=s.node.querySelector(".jp-FileBrowser-crumbs");if(t){const e=()=>{if(!t.isConnected)return;s.model.pathChanged.disconnect(e);const a=n.ReactWidget.create(c().createElement(n.UseSignal,{signal:s.model.pathChanged,initialSender:s.model},(e=>c().createElement(b,{currentPath:(null==e?void 0:e.path)||"",manager:h,handleClick:e=>{if(h.hasFavorite(e))h.removeFavorite(e);else{const t={root:h.serverRoot,contentType:"directory",iconLabel:n.folderIcon.name,path:e};h.addFavorite(t)}}}))));a.addClass("jp-Favorites-pinner"),l.Widget.attach(a,t),t.insertAdjacentElement("beforebegin",a.node),t.classList.add("jp-Favorites-crumbs")};s.model.pathChanged.connect(e),e()}}const g=()=>{const e=F.currentWidget;return e?Array.from(e.selectedItems()):[]},{tracker:F}=t;if(v.addCommand(C.addOrRemoveFavorite,{execute:()=>{var e;const t=g();if(t.length>0){const a=t[0];if(h.hasFavorite(a.path))h.removeFavorite(a.path);else{const t=r.getFileTypeForModel(a);h.addFavorite({root:h.serverRoot,path:a.path,contentType:t.contentType,iconLabel:null===(e=t.icon)||void 0===e?void 0:e.name})}}},isVisible:()=>1===g().length,icon:()=>{const e=g()[0];return f(!h.hasFavorite(e.path))},label:()=>{const e=g()[0];return u(h.hasFavorite(e.path))}}),v.addCommand(C.removeFavorite,{execute:()=>{const t=e.contextMenuHitTest((e=>e.classList.contains("jp-Favorites-item"))).dataset.path;h.removeFavorite(t)},icon:m,label:"Remove Favorite"}),v.addCommand(C.renameFavorite,{execute:async t=>{var a;let{path:i,displayName:s}=t;if(i||(i=e.contextMenuHitTest((e=>e.classList.contains("jp-Favorites-item"))).dataset.path),i){if(!s){const e=await M.InputDialog.getText({title:"Rename favorite",label:`Name for favorite at '${i}'`,okLabel:"Rename",placeholder:"Display name"});s=e.button.accept&&null!==(a=e.value)&&void 0!==a?a:""}s&&h.renameFavorite(i,s)}},label:"Rename Favorite"}),v.addCommand(C.openFavorite,{execute:async e=>{const t=e.favorite,a=""===t.path?"/":t.path;await v.execute("filebrowser:open-path",{path:a})},label:e=>{const t=e.favorite;return p(t.root,t.path)}}),v.addCommand(C.toggleFavoritesWidget,{execute:async e=>{const t=e.showWidget;h.saveSettings({showWidget:!t})},label:e=>(e.showWidget?"Hide":"Show")+" Favorites Widget",isVisible:()=>h.visibleFavorites().length>0}),v.addCommand(C.restoreDefaults,{execute:()=>h.restoreDefaults(),label:"Restore Defaults"}),v.addCommand(C.clearFavorites,{execute:()=>h.clearFavorites(),label:"Clear Favorites"}),o){o.fileMenu.addGroup([{type:"submenu",submenu:h.favoritesMenu}],1);try{const e=o.fileMenu._ranks;let t=0,a=-1;for(let i=0;i<e.length;i++)1===e[i].rank&&(t+=1,a<0&&(a=i));if(2===t){const t=e[a];t.size=t.size+1,e.splice(a+1,1);const i=o.fileMenu.menu,s=i._items;let r=!1;for(let e=s.length-1;e>0;e--){const t=s[e];if("filebrowser:open-path"===t.command)break;r&&"separator"===t.type?i.removeItemAt(e):"submenu"===t.type&&"Favorites"===t.submenu.title.label&&(r=!0)}}}catch(e){console.log(e)}}return h}}}}]);