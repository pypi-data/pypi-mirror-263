(function(){"use strict";navigator.userAgent.includes("Win");function p(n){return n===!1}function w(n){return a(n)||n===""}function a(n){return n==null}function g(...n){return n.filter(Boolean).join("__")}const r={Upstream:"upstream",Downstream:"downstream"},d=self;d.onmessage=async n=>{if(n.data.topic==="lineage")try{const{currentLineage:t,newLineage:e,mainNode:o}=n.data.payload,s=await D(t,e),c=await y(o,s);d.postMessage({topic:"lineage",payload:{lineage:s,nodesConnections:c}})}catch(t){d.postMessage({topic:"error",error:t})}};async function D(n={},t={}){return Object.entries(t).reduce((e,[o,s=[]])=>{var c;return o=encodeURI(o),e[o]={models:s.map(encodeURI),columns:((c=n==null?void 0:n[o])==null?void 0:c.columns)??void 0},e},{})}async function y(n,t={}){return new Promise((e,o)=>{if(a(t)||a(n))return{};const s={};try{m(r.Upstream,n,t,s),m(r.Downstream,n,t,s)}catch(c){o(c)}e(s)})}function m(n=r.Downstream,t,e={},o={}){var u;const s=n===r.Downstream;let c=[];s?c=Object.keys(e).filter(i=>e[i].models.includes(t)):c=((u=e[t])==null?void 0:u.models)??[],p(t in o)&&(o[t]=f());for(const i of c){const l=s?f(t,i,[o[t]]):f(i,t,[o[t]]);i in o?o[i].edges.push(l):(o[i]=l,m(n,i,e,o))}}function f(n,t,e=[]){const o=g(n,t);return{id:w(o)?void 0:o,edges:e}}})();
