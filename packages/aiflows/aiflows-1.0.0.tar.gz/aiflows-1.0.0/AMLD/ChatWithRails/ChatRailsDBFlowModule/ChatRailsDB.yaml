name: ChatRailsDB
description: A sequential flow that calls a safeguard flow and then a chatbot flow.         The
  safeguard flow checks for prompt injections.
_target_: ChatRailsDBFlowModule.ChatRailsDB.ChatRailsDB.instantiate_from_default_config
input_interface: question
output_interface: answer
subflows_config:
  Safeguard:
    _target_: aiflows.base_flows.AtomicFlow.instantiate_from_default_config
    user_id: local
    name: Proxy of PromptInjectionDetectorFlow.
    flow_endpoint: PromptInjectionDetectorFlow
    description: A proxy flow that checks for prompt injections.
  DB:
    _target_: flow_modules.aiflows.VectorStoreFlowModule.ChromaDBFlow.instantiate_from_default_config
    name: DB
    description: Database flow
    paths_to_data:
    - ./data/paul_graham_essay.txt
    flow_class_name: flow_modules.aiflows.VectorStoreFlowModule.ChromaDBFlow
    flow_endpoint: DB
    user_id: local
    similarity_search_kwargs:
      k: 1
    backend:
      api_infos: ???
  ChatBot:
    _target_: flow_modules.aiflows.ChatFlowModule.ChatAtomicFlow.instantiate_from_default_config
    flow_class_name: flow_modules.aiflows.ChatFlowModule.ChatAtomicFlow
    user_id: local
    flow_endpoint: Chat Flow
    name: Proxy of Chat Flow
    backend:
      api_infos: ???
      model_name:
        openai: gpt-4
    input_interface:
    - question
    - memory
    input_interface_non_initialized:
    - question
    - memory
    description: A proxy flow that calls an LLM model to generate a response, if the
      prompt is valid (no injection).
    system_message_prompt_template:
      template: 'You are a helpful chatbot that truthfully answers questions only
        related to information extracted from your Memory (this will be passed to
        you in the prompt).                     If the question is not related to
        what you extracted from memory then simply reply with the following: ''This
        question is not valid. I cannot answer it.'''
    init_human_message_prompt_template:
      template: "Question: {{question}} \n\n Memory: {{memory}}"
      input_variables:
      - question
      - memory
    human_message_prompt_template:
      template: "Question: {{question}} \n\n Memory: {{memory}}"
      input_variables:
      - question
      - memory
    previous_messages:
      first_k: null
      last_k: null
