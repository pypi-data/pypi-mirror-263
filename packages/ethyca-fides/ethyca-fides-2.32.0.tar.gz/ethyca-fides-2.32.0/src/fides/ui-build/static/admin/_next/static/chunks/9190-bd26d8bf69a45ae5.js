"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9190],{86054:function(e,n,t){var i=t(90849),a=t(90089),r=t(34896),s=t(38687),o=t(24246),l=["title","tooltip","children"];function c(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?c(Object(t),!0).forEach((function(n){(0,i.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}n.Z=function(e){var n=e.title,t=e.tooltip,i=e.children,c=(0,a.Z)(e,l);return(0,o.jsxs)(r.xu,u(u({borderRadius:"md",border:"1px solid",borderColor:"gray.200"},c),{},{children:[(0,o.jsxs)(r.X6,{as:"h3",fontSize:"sm",fontWeight:"semibold",color:"gray.700",py:4,px:6,backgroundColor:"gray.50",borderRadius:"md",textAlign:"left",children:[n,t?(0,o.jsx)(r.xv,{as:"span",mx:1,children:(0,o.jsx)(s.Z,{label:t})}):void 0]}),(0,o.jsx)(r.Kq,{p:6,spacing:6,children:i})]}))}},59190:function(e,n,t){t.d(n,{Z:function(){return Y}});var i=t(55732),a=t(97865),r=t(90849),s=t(34707),o=t.n(s),l=t(34896),c=t(92975),u=t(70409),d=t(29549),f=t(58981),p=t(34090),g=t(86677),v=t(27378),m=t(6848),h=t(86054),b=t(43139),j=t(78624),x=t(60709),y=t(64429),O=t(38687),_=t(24753),w=t(75846),P=t(73679),k=t(20294),C=t(73452),S=t(49601),Z=t(66464),D=t(24246),z=function(e){var n=e.index,t=e.name,i=e.isOOB;return(0,D.jsxs)(l.kC,{direction:"column",gap:6,children:[(0,D.jsxs)(l.X6,{size:"sm",children:["Edit ",t," translation"]}),i?(0,D.jsx)(Z.f,{languageName:t}):null,(0,D.jsx)(b.j0,{autoFocus:0!==n,name:"translations.".concat(n,".title"),label:"Title of consent notice as displayed to user",variant:"stacked"}),(0,D.jsx)(b.Ks,{name:"translations.".concat(n,".description"),label:"Privacy notice displayed to the user",variant:"stacked"})]})},E=function(e){var n=e.translation,t=e.name,i=e.onLanguageDeleted;return(0,D.jsxs)(l.kC,{gap:2,direction:"row",w:"100%",children:[(0,D.jsx)(k.OK,{as:d.zx,variant:"outline",size:"sm",fontWeight:"normal",w:"100%",_selected:{color:"white",bg:"gray.500"},children:t},n.language),i?(0,D.jsx)(d.hU,{"aria-label":"Delete translation",variant:"outline",size:"sm",onClick:function(){return i(n.language)},children:(0,D.jsx)(C.pJ,{boxSize:4})}):null]})},N=function(e){var n=e.availableTranslations,t=(0,p.u6)(),i=t.values,a=t.setFieldValue,r=(0,v.useState)(!1),s=r[0],o=r[1],c=(0,v.useState)(!1),u=c[0],g=c[1],j=(0,v.useState)(0),x=j[0],y=j[1],O=(0,m.C)(S.Zp),_=(0,m.C)(S.G1);(0,S.Ah)({page:O,size:_});var w=(0,m.C)(S.fJ).slice().sort((function(e,n){return e.name.localeCompare(n.name)})),Z=w.filter((function(e){var n;return null===(n=i.translations)||void 0===n?void 0:n.every((function(n){return n.language!==e.id}))})).map((function(e){return{label:e.name,value:e.id}})),N=function(e){var n=i.translations?i.translations.slice().filter((function(n){return n.language!==e})):[],t=x===n.length?n.length-1:x;a("translations",n),y(t)},T=function(e){var n,t;return null!==(n=null===(t=w.find((function(n){return n.id===e})))||void 0===t?void 0:t.name)&&void 0!==n?n:e};return(0,D.jsx)(h.Z,{title:"Localizations",children:(0,D.jsxs)(k.mQ,{index:x,onChange:function(e){y(e),g(!1)},as:l.Ug,spacing:8,align:"start",grow:1,w:"100%",orientation:"vertical",variant:"unstyled",children:[(0,D.jsxs)(l.gC,{spacing:4,minW:"30%",p:2,children:[(0,D.jsx)(k.td,{w:"100%",children:(0,D.jsx)(l.gC,{spacing:2,w:"100%",p:4,maxH:60,overflow:"scroll",outline:"1px solid",outlineColor:"gray.200",borderRadius:"md",children:i.translations.map((function(e){return(0,D.jsx)(E,{translation:e,name:T(e.language),onLanguageDeleted:N},e.language)}))})}),s?(0,D.jsx)(l.xu,{w:"full","data-testid":"select-language",children:(0,D.jsx)(f.Z,{chakraStyles:b.hP,size:"sm",options:Z,onChange:function(e){return function(e){var t=null===n||void 0===n?void 0:n.find((function(n){return n.language===e}));g(!!t);var r=null!==t&&void 0!==t?t:{language:e,title:"",description:""};y(i.translations.length),a("translations",[].concat((0,P.Z)(i.translations),[r])),o(!1)}(e.value)},autoFocus:!0,classNamePrefix:"select-language",menuPlacement:"auto"})}):null,!s&&Z.length?(0,D.jsx)(d.zx,{leftIcon:(0,D.jsx)(C.jB,{boxSize:6}),w:"full",variant:"outline",size:"sm",onClick:function(){return o(!0)},"data-testid":"add-language-btn",children:"Add a language"}):null]}),(0,D.jsx)(l.xu,{w:"100%",children:(0,D.jsx)(p.F2,{name:"translations",render:function(){return(0,D.jsx)(k.nP,{w:"100%",children:i.translations.map((function(e,n){return(0,D.jsx)(k.x4,{children:(0,D.jsx)(z,{index:n,name:T(e.language),isOOB:u})},e.language)}))})}})})]})})},T=t(90089),R=t(68301),q=t(9865),F=["privacy_notice_history_id"];function I(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function J(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?I(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):I(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var L=[{label:"Opt in",value:q.J7.OPT_IN},{label:"Opt out",value:q.J7.OPT_OUT},{label:"Notice only",value:q.J7.NOTICE_ONLY}],K=[{language:q.eU.EN,title:"",description:""}],V={name:"",consent_mechanism:q.J7.OPT_IN,data_uses:[],enforcement_level:q.QT.SYSTEM_WIDE,disabled:!0,translations:K},A=R.Ry().shape({name:R.Z_().required().label("Title"),consent_mechanism:R.Z_().required().label("Consent mechanism")}),M=t(14441),U=t.n(M),W=function(e){var n=e.isEditing,t=(0,p.u6)(),i=t.values,a=t.setFieldValue;return(0,v.useEffect)((function(){if(!n){var e=U()(i.name);a("notice_key",e)}}),[i.name,n,a]),(0,D.jsx)(b.j0,{name:"notice_key",label:"Key used in Fides cookie",variant:"stacked"})},B=t(15749);function X(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function G(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?X(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):X(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Q=function(e){var n,t=e.regions,i=e.label,a=e.tooltip;return(0,D.jsxs)(l.gC,{align:"start",children:[(0,D.jsxs)(l.kC,{align:"start",children:[i?(0,D.jsx)(c.lX,{htmlFor:"regions",fontSize:"xs",my:0,mr:1,children:i}):null,a?(0,D.jsx)(O.Z,{label:a}):null]}),(0,D.jsx)(l.xu,{w:"100%","data-testid":"notice-locations",children:(0,D.jsx)(f.Z,{chakraStyles:G(G({},b.hP),{},{dropdownIndicator:function(e){return G(G({},e),{},{display:"none"})},multiValueRemove:function(e){return G(G({},e),{},{display:"none"})}}),classNamePrefix:"notice-locations",size:"sm",isMulti:!0,isDisabled:!0,placeholder:"No locations assigned",value:null!==(n=null===t||void 0===t?void 0:t.map((function(e){return{label:y.Z8[e],value:e}})))&&void 0!==n?n:[]})})]})},Y=function(e){var n=e.privacyNotice,t=e.availableTranslations,r=(0,g.useRouter)(),s=(0,u.pm)(),c=n?function(e){var n,t,i,a;return{name:null!==(n=e.name)&&void 0!==n?n:V.name,consent_mechanism:null!==(t=e.consent_mechanism)&&void 0!==t?t:V.consent_mechanism,data_uses:null!==(i=e.data_uses)&&void 0!==i?i:V.data_uses,enforcement_level:null!==(a=e.enforcement_level)&&void 0!==a?a:V.enforcement_level,notice_key:e.notice_key,disabled:e.disabled,has_gpc_flag:e.has_gpc_flag,id:e.id,internal_description:e.internal_description,translations:e.translations?e.translations.map((function(e){var n;return e.privacy_notice_history_id,J(J({},(0,T.Z)(e,F)),{},{title:null!==(n=e.title)&&void 0!==n?n:""})})):K}}(n):V;(0,w.fd)();var f=(0,m.C)(w.qv),y=(0,B.vL)(),O=(0,a.Z)(y,1)[0],P=(0,B.p4)(),k=(0,a.Z)(P,1)[0],C=(0,v.useMemo)((function(){return!!n}),[n]),S=function(){var e=(0,i.Z)(o().mark((function e(t){var i,a,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!C){e.next=7;break}return l=G(G({},t),{},{id:n.id,enforcement_level:n.enforcement_level,translations:null!==(a=t.translations)&&void 0!==a?a:[]}),e.next=4,O(l);case 4:i=e.sent,e.next=10;break;case 7:return e.next=9,k(t);case 9:i=e.sent;case 10:(0,j.D4)(i)?s((0,_.Vo)((0,j.e$)(i.error))):(s((0,_.t5)("Privacy notice ".concat(C?"updated":"created"))),C||r.push(x.IT));case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,D.jsx)(p.J9,{initialValues:c,enableReinitialize:!0,onSubmit:S,validationSchema:A,children:function(e){var i=e.dirty,a=e.isValid,s=e.isSubmitting;return(0,D.jsx)(p.l0,{children:(0,D.jsxs)(l.Kq,{spacing:10,children:[(0,D.jsxs)(l.Kq,{spacing:6,children:[(0,D.jsxs)(h.Z,{title:"Privacy notice details",children:[(0,D.jsx)(b.j0,{label:"Notice title",name:"name",isRequired:!0,variant:"stacked"}),(0,D.jsx)(b.AP,{name:"consent_mechanism",label:"Consent mechanism",options:L,isRequired:!0,variant:"stacked"}),(0,D.jsx)(W,{isEditing:C}),(0,D.jsx)(Q,{regions:null===n||void 0===n?void 0:n.configured_regions,label:"Locations where consent notice is shown to visitors",tooltip:"To configure locations, change the privacy experiences where this notice is shown"}),(0,D.jsx)(b.w8,{name:"has_gpc_flag",label:"Configure whether this notice conforms to the Global Privacy Control",variant:"stacked"}),(0,D.jsx)(b.AP,{name:"data_uses",label:"Data use",options:f,isMulti:!0,variant:"stacked"})]}),(0,D.jsx)(N,{availableTranslations:t})]}),(0,D.jsxs)(d.hE,{size:"sm",spacing:2,children:[(0,D.jsx)(d.zx,{variant:"outline",onClick:function(){r.back()},children:"Cancel"}),(0,D.jsx)(d.zx,{type:"submit",variant:"primary",size:"sm",isDisabled:s||!i||!a,isLoading:s,"data-testid":"save-btn",children:"Save"})]})]})})}})}}}]);